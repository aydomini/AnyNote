import{j as e}from"./markdown-vendor-CHUou9Sa.js";import{u as Ne,r as d}from"./react-vendor-9esfqqE9.js";import{E as fe}from"./index-C-GWJ8ez.js";import{u as ke,a as ve,b as o}from"./index-Dt62Q5Mp.js";import{u as je}from"./index-DmPTVDsj.js";import{a as Ce,u as we,T as ze}from"./Toast-ClRAtSG1.js";import"./zustand-vendor-CzPTHOhB.js";function Ee(){const C=Ne(),{token:m,user:N}=ke(),{theme:w,setTheme:Z,language:t,setLanguage:ee}=ve(),{t:n}=je(),te=()=>w,[U,ae]=d.useState(()=>{try{return sessionStorage.getItem("anynote-admin-verified")==="true"}catch{return!1}}),[y,se]=d.useState(()=>{try{return sessionStorage.getItem("anynote-admin-password")||""}catch{return""}}),[W,f]=d.useState(""),[X,B]=d.useState(!1),[T,k]=d.useState(""),[re,V]=d.useState(0),[v,P]=d.useState(!1),[F,ne]=d.useState([]),[z,H]=d.useState(!1),{toast:M,showToast:i,hideToast:ie}=Ce(),{confirm:E,ConfirmDialog:de}=we(),[$,oe]=d.useState([]),[S,K]=d.useState(!1),[I,R]=d.useState(new Set),[r,le]=d.useState(null),[p,q]=d.useState(!1),[G,Y]=d.useState(!1),[ce,_]=d.useState(!1),[g,xe]=d.useState(null),[c,b]=d.useState({code:"",max_uses:1,expires_days:1,note:""}),J=()=>{const a="ACDEFGHJKLMNPQRTUVWXYacdefghjkmnpqrtuvwxy34679",s=[];for(let x=0;x<4;x++){let h="";for(let j=0;j<5;j++)h+=a.charAt(Math.floor(Math.random()*a.length));s.push(h)}const l=`AnyNote-${s.join("-")}`;b({...c,code:l})},O=async()=>{var a,s;if(!T){f(t==="zh-CN"?"请完成人机验证":"Please complete verification");return}f(""),B(!0);try{o.setToken(m);const l=await o.verifyAdminPassword(y);if(l.success){ae(!0),P(!1);try{sessionStorage.setItem("anynote-admin-verified","true"),sessionStorage.setItem("anynote-admin-password",y)}catch(x){console.warn("Failed to save admin verification state:",x)}u(),L(),D()}else f(((a=l.error)==null?void 0:a.message)||(t==="zh-CN"?"验证失败":"Verification failed")),((s=l.error)==null?void 0:s.code)==="ADMIN_BANNED"&&P(!0),k(""),V(x=>x+1)}catch(l){f(l.message||(t==="zh-CN"?"验证失败":"Verification failed")),k(""),V(x=>x+1)}finally{B(!1)}},u=async()=>{H(!0);try{o.setToken(m);const a=await o.getInviteCodes();a.success&&a.data&&ne(a.data.invite_codes)}catch(a){i(a.message||(t==="zh-CN"?"加载失败":"Load failed"),{variant:"error"})}finally{H(!1)}},L=async()=>{K(!0);try{o.setToken(m);const a=await o.getUsers();a.success&&a.data&&oe(a.data.users)}catch(a){i(a.message||n.admin.users.loadFailed,{variant:"error"})}finally{K(!1)}},D=async()=>{q(!0);try{o.setToken(m);const a=await o.getAdminStats(y);a.success&&a.data&&le(a.data)}catch(a){i(a.message||(t==="zh-CN"?"加载统计数据失败":"Load statistics failed"),{variant:"error"})}finally{q(!1)}},me=async()=>{var s;if(await E({title:n.admin.confirmations.cleanupTitle,description:n.admin.confirmations.cleanupDescription,confirmLabel:n.admin.confirmations.cleanupConfirm,cancelLabel:n.common.cancel,variant:"danger"})){Y(!0);try{o.setToken(m);const l=await o.cleanupData(y);l.success?(i(n.admin.notifications.cleanupSuccess,{variant:"success"}),D(),u()):i(((s=l.error)==null?void 0:s.message)||(t==="zh-CN"?"清理失败":"Cleanup failed"),{variant:"error"})}catch(l){i(l.message||(t==="zh-CN"?"清理失败":"Cleanup failed"),{variant:"error"})}finally{Y(!1)}}},he=async(a,s)=>{var x;if((N==null?void 0:N.email)===s){i(n.admin.confirmations.cannotDeleteSelf,{variant:"error"});return}if(await E({title:n.admin.confirmations.deleteUserTitle,description:n.admin.confirmations.deleteUserDescription.replace("{email}",s),confirmLabel:n.common.delete,cancelLabel:n.common.cancel,variant:"danger"})){R(h=>new Set(h).add(a));try{o.setToken(m);const h=await o.deleteUser(a);h.success?(i(t==="zh-CN"?"用户已删除！":"User deleted successfully!",{variant:"success"}),L()):i(((x=h.error)==null?void 0:x.message)||(t==="zh-CN"?"删除失败":"Delete failed"),{variant:"error"})}catch(h){i(h.message||(t==="zh-CN"?"删除失败":"Delete failed"),{variant:"error"})}finally{R(h=>{const j=new Set(h);return j.delete(a),j})}}},ge=async()=>{var a;try{const s=c.expires_days>0?Date.now()+c.expires_days*24*60*60*1e3:null;o.setToken(m);const l=await o.createInviteCode({code:c.code,max_uses:c.max_uses,expires_at:s});l.success?(i(t==="zh-CN"?"创建成功！":"Created successfully!",{variant:"success"}),_(!1),A(),u()):i(((a=l.error)==null?void 0:a.message)||(t==="zh-CN"?"创建失败":"Create failed"),{variant:"error"})}catch(s){i(s.message||(t==="zh-CN"?"创建失败":"Create failed"),{variant:"error"})}},ue=async()=>{var a;if(g)try{o.setToken(m);const s=await o.updateInviteCode(g.id,{max_uses:c.max_uses,is_active:g.is_active});s.success?(i(t==="zh-CN"?"更新成功！":"Updated successfully!",{variant:"success"}),_(!1),A(),u()):i(((a=s.error)==null?void 0:a.message)||(t==="zh-CN"?"更新失败":"Update failed"),{variant:"error"})}catch(s){i(s.message||(t==="zh-CN"?"更新失败":"Update failed"),{variant:"error"})}},ye=async a=>{var l;if(await E({title:n.admin.confirmations.deleteInviteTitle,description:n.admin.confirmations.deleteInviteDescription,confirmLabel:n.common.delete,cancelLabel:n.common.cancel,variant:"danger"}))try{o.setToken(m);const x=await o.deleteInviteCode(a);x.success?(i(t==="zh-CN"?"删除成功！":"Deleted successfully!",{variant:"success"}),u()):i(((l=x.error)==null?void 0:l.message)||(t==="zh-CN"?"删除失败":"Delete failed"),{variant:"error"})}catch(x){i(x.message||(t==="zh-CN"?"删除失败":"Delete failed"),{variant:"error"})}},pe=async a=>{try{o.setToken(m),(await o.updateInviteCode(a.id,{is_active:a.is_active===1?0:1})).success&&u()}catch(s){i(s.message||(t==="zh-CN"?"更新失败":"Update failed"),{variant:"error"})}},A=()=>{b({code:"",max_uses:1,expires_days:1,note:""}),xe(null)},be=a=>new Date(a).toLocaleDateString(t==="zh-CN"?"zh-CN":"en-US"),Q=a=>a&&a<Date.now();return d.useEffect(()=>{m||C("/login")},[m,C]),d.useEffect(()=>{U&&m&&(u(),L(),D())},[]),U?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20",children:[e.jsx("header",{className:"bg-white/80 dark:bg-gray-800/50 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.svg",alt:"AnyNote",className:"w-8 h-8"}),e.jsx("button",{onClick:()=>{try{sessionStorage.removeItem("anynote-admin-verified"),sessionStorage.removeItem("anynote-admin-password")}catch(a){console.warn("Failed to clear admin state:",a)}C("/notes")},title:t==="zh-CN"?"点击返回笔记":"Click to return to Notes",children:e.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-blue-400 hover:from-blue-500 hover:to-blue-500 transition-all cursor-pointer",children:n.admin.title})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:me,disabled:G||z||S||p,className:"text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg disabled:opacity-50",title:t==="zh-CN"?"清理过期数据":"Clean up expired data",children:e.jsx("svg",{className:`w-5 h-5 ${G?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("button",{onClick:()=>{D(),u(),L()},disabled:z||S||p,className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700/50 rounded-lg disabled:opacity-50",title:t==="zh-CN"?"刷新所有数据":"Refresh all data",children:e.jsx("svg",{className:`w-5 h-5 ${z||S||p?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>Z(w==="light"?"dark":"light"),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700/50 rounded-lg",title:w==="light"?n.nav.themeDark:n.nav.themeLight,children:w==="light"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),e.jsx("button",{onClick:()=>ee(t==="zh-CN"?"en-US":"zh-CN"),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors px-2 py-1.5 hover:bg-gray-200 dark:hover:bg-gray-700/50 rounded-lg text-sm font-medium",title:t==="zh-CN"?"Switch to English":"切换到中文",children:t==="zh-CN"?"EN":"中"})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 border border-blue-200 dark:border-blue-700 rounded-xl p-4 h-[180px] flex flex-col",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-700 dark:text-blue-300 mb-3",children:t==="zh-CN"?"总数统计":"Total"}),r?e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"用户":"Users",":"]}),e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:r.total.users})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"笔记":"Notes",":"]}),e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:r.total.notes})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"密码":"Passwords",":"]}),e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:r.total.passwords})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"会话":"Sessions",":"]}),e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:r.total.sessions})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"邀请码":"Codes",":"]}),e.jsx("span",{className:"font-semibold text-blue-700 dark:text-blue-300",children:r.total.invite_codes})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 text-sm py-8",children:p?t==="zh-CN"?"加载中...":"Loading...":t==="zh-CN"?"暂无数据":"No data"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/20 border border-green-200 dark:border-green-700 rounded-xl p-4 h-[180px] flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-semibold text-green-700 dark:text-green-300",children:t==="zh-CN"?"有效数据":"Active"})}),r?e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"在线会话":"Active Sessions",":"]}),e.jsx("span",{className:"font-semibold text-green-700 dark:text-green-300",children:r.active.sessions})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"启用邀请码":"Active Codes",":"]}),e.jsx("span",{className:"font-semibold text-green-700 dark:text-green-300",children:r.active.invite_codes})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 text-sm py-8",children:p?t==="zh-CN"?"加载中...":"Loading...":t==="zh-CN"?"暂无数据":"No data"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/20 border border-red-200 dark:border-red-700 rounded-xl p-4 h-[180px] flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-semibold text-red-700 dark:text-red-300",children:t==="zh-CN"?"过期数据":"Expired"})}),r?e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"过期会话":"Expired Sessions",":"]}),e.jsx("span",{className:"font-semibold text-red-700 dark:text-red-300",children:r.expired.sessions})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"过期邀请码":"Expired Codes",":"]}),e.jsx("span",{className:"font-semibold text-red-700 dark:text-red-300",children:r.expired.invite_codes})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 text-sm py-8",children:p?t==="zh-CN"?"加载中...":"Loading...":t==="zh-CN"?"暂无数据":"No data"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/30 dark:to-orange-800/20 border border-orange-200 dark:border-orange-700 rounded-xl p-4 h-[180px] flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h3",{className:"text-sm font-semibold text-orange-700 dark:text-orange-300",children:t==="zh-CN"?"已登出":"Inactive"})}),r?e.jsx("div",{className:"space-y-1 text-sm",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[t==="zh-CN"?"已登出会话":"Inactive Sessions",":"]}),e.jsx("span",{className:"font-semibold text-orange-700 dark:text-orange-300",children:r.inactive.sessions})]})}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 text-sm py-8",children:p?t==="zh-CN"?"加载中...":"Loading...":t==="zh-CN"?"暂无数据":"No data"})]})]}),(r==null?void 0:r.storage)&&e.jsxs("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:t==="zh-CN"?"存储占用":"Storage Usage"}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${r.storage.status==="critical"?"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200":r.storage.status==="warning"?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200":"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200"}`,children:r.storage.status==="critical"?t==="zh-CN"?"接近上限":"Critical":r.storage.status==="warning"?t==="zh-CN"?"注意":"Warning":t==="zh-CN"?"正常":"Normal"})]}),e.jsxs("div",{className:"relative w-full bg-gray-200 dark:bg-gray-700 rounded-full h-5 overflow-hidden",children:[e.jsx("div",{className:`h-full transition-all duration-300 ${r.storage.status==="critical"?"bg-red-500 dark:bg-red-600":r.storage.status==="warning"?"bg-yellow-500 dark:bg-yellow-600":"bg-green-500 dark:bg-green-600"}`,style:{width:`${Math.min(r.storage.usagePercent,100)}%`}}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium text-gray-700 dark:text-gray-200 transition-colors",children:[r.storage.actualUsageMB.toFixed(2)," MB / ",r.storage.limitMB," MB (",r.storage.usagePercent.toFixed(2),"%)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-[200px]",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-200 dark:border-gray-700 overflow-hidden h-full flex flex-col",children:z?e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:t==="zh-CN"?"加载中...":"Loading..."}):e.jsx("div",{className:"overflow-x-auto overflow-y-auto flex-1",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"30%",minWidth:"120px"},children:e.jsx("button",{onClick:()=>{A(),J(),_(!0)},className:"text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors font-medium",title:t==="zh-CN"?"点击创建新邀请码":"Click to create new code",children:t==="zh-CN"?"邀请码":"Code"})}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"15%",minWidth:"80px"},children:t==="zh-CN"?"使用":"Usage"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"25%",minWidth:"120px"},children:t==="zh-CN"?"过期时间":"Expires"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"10%",minWidth:"80px"},children:t==="zh-CN"?"状态":"Status"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"20%",minWidth:"90px"},children:t==="zh-CN"?"操作":"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-16 text-center text-sm text-gray-500 dark:text-gray-400",children:t==="zh-CN"?'暂无邀请码，点击"邀请码"列标题创建':'No invite codes. Click "Code" column header to create.'})}):F.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-2 text-center text-sm",children:e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(a.code),i(t==="zh-CN"?"✓ 邀请码已复制！":"✓ Code copied!",{variant:"success"})},className:"text-gray-900 dark:text-gray-100 hover:text-blue-600 dark:hover:text-blue-400 transition-colors cursor-pointer",title:t==="zh-CN"?"点击复制完整邀请码":"Click to copy full code",children:[a.code.substring(0,8),"...",a.code.substring(a.code.length-5)]})}),e.jsxs("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:[a.used_count," / ",a.max_uses===-1?"∞":a.max_uses]}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:a.expires_at?e.jsxs("span",{className:Q(a.expires_at)?"text-red-500":"",children:[be(a.expires_at),Q(a.expires_at)&&" ⚠️"]}):t==="zh-CN"?"永不":"Never"}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:e.jsx("button",{onClick:()=>pe(a),className:"p-0.5 hover:bg-gray-100 dark:hover:bg-gray-700/50 rounded transition-colors",title:a.is_active===1?t==="zh-CN"?"点击禁用":"Click to disable":t==="zh-CN"?"点击启用":"Click to enable",children:a.is_active===1?e.jsx("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"w-4 h-4 text-gray-400 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:e.jsx("button",{onClick:()=>ye(a.id),className:"p-0.5 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors",title:t==="zh-CN"?"删除":"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},a.id))})]})})})}),e.jsx("div",{className:"h-[200px]",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow border border-gray-200 dark:border-gray-700 overflow-hidden h-full flex flex-col",children:S?e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:n.admin.users.loading}):$.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:n.admin.users.noUsers}):e.jsx("div",{className:"overflow-x-auto overflow-y-auto flex-1",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"40%",minWidth:"150px"},children:n.admin.users.email}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"10%",minWidth:"90px"},children:n.admin.users.notesCount}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"10%",minWidth:"90px"},children:n.admin.users.passwordsCount}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"10%",minWidth:"90px"},children:n.admin.users.devicesCount}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider whitespace-nowrap",style:{width:"30%",minWidth:"120px"},children:n.admin.users.createdAt})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:$.map(a=>{const s=(N==null?void 0:N.email)===a.email;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-2 text-center text-sm",children:[e.jsx("button",{onClick:()=>he(a.id,a.email),disabled:I.has(a.id)||s,className:`transition-colors ${s?"text-gray-900 dark:text-gray-100 cursor-not-allowed":I.has(a.id)?"text-gray-400 dark:text-gray-600 cursor-wait":"text-gray-900 dark:text-gray-100 hover:text-red-600 dark:hover:text-red-400"}`,title:s?t==="zh-CN"?"无法删除自己":"Cannot delete yourself":I.has(a.id)?t==="zh-CN"?"删除中...":"Deleting...":t==="zh-CN"?"点击删除用户":"Click to delete user",children:a.email}),s&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded",children:t==="zh-CN"?"你":"You"})]}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:a.notes_count}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:a.passwords_count}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:a.devices_count}),e.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-600 dark:text-gray-400",children:new Date(a.created_at).toLocaleDateString(t==="zh-CN"?"zh-CN":"en-US")})]},a.id)})})]})})})})]}),ce&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:g?t==="zh-CN"?"编辑邀请码":"Edit Code":t==="zh-CN"?"创建邀请码":"Create Code"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t==="zh-CN"?"邀请码":"Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:c.code,onChange:a=>b({...c,code:a.target.value.toUpperCase()}),disabled:!!g,placeholder:"XXXXXXXXXXXXXXXX",className:"flex-1 px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white font-mono disabled:opacity-50"}),!g&&e.jsx("button",{onClick:J,className:"px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-1",title:t==="zh-CN"?"生成随机邀请码":"Generate random code",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t==="zh-CN"?"使用次数限制":"Usage Limit"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",checked:c.max_uses===0,onChange:()=>b({...c,max_uses:0}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t==="zh-CN"?"无限次":"Unlimited"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",checked:c.max_uses===1,onChange:()=>b({...c,max_uses:1}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t==="zh-CN"?"单次使用":"One-time"})]})]})]}),!g&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t==="zh-CN"?"有效期":"Validity"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",checked:c.expires_days===0,onChange:()=>b({...c,expires_days:0}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t==="zh-CN"?"永久有效":"Permanent"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",checked:c.expires_days===1,onChange:()=>b({...c,expires_days:1}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t==="zh-CN"?"1天后过期":"1 day"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{_(!1),A()},className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:t==="zh-CN"?"取消":"Cancel"}),e.jsx("button",{onClick:g?ue:ge,disabled:!c.code,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:g?t==="zh-CN"?"更新":"Update":t==="zh-CN"?"创建":"Create"})]})]})}),de,M&&e.jsx(ze,{message:M.message,variant:M.variant,onClose:ie})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20 px-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-2xl rounded-2xl p-6 border border-white/60 dark:border-white/20 shadow-[0_30px_80px_-35px_rgba(37,99,235,0.4)] dark:shadow-[0_30px_80px_-35px_rgba(96,165,250,0.5)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("img",{src:"/logo.svg",alt:"AnyNote",className:"w-12 h-12"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t==="zh-CN"?"管理员验证":"Admin Verification"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t==="zh-CN"?"邀请码管理系统":"Invite Code Management"})]})]}),W&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:W})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t==="zh-CN"?"管理员密码":"Admin Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"password",value:y,onChange:a=>{se(a.target.value),v||f("")},onKeyDown:a=>a.key==="Enter"&&!v&&T&&O(),disabled:v,minLength:12,maxLength:32,placeholder:t==="zh-CN"?"请输入管理员密码":"Enter admin password",className:"w-full px-4 py-2 pr-16 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[y.length,"/32"]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(fe,{siteKey:"0x4AAAAAAB7UqdxFxx0kLl6i",onSuccess:a=>k(a),onError:()=>k(""),onExpire:()=>k(""),options:{theme:te(),size:"flexible",language:t==="zh-CN"?"zh-CN":"en"}},re)}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{try{sessionStorage.removeItem("anynote-admin-verified"),sessionStorage.removeItem("anynote-admin-password")}catch(a){console.warn("Failed to clear admin state:",a)}C("/notes")},className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:t==="zh-CN"?"返回":"Back"}),e.jsx("button",{onClick:O,disabled:!y||!T||X||v,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:v?t==="zh-CN"?"已锁定":"Locked":X?t==="zh-CN"?"验证中...":"Verifying...":t==="zh-CN"?"验证":"Verify"})]})]})})})}export{Ee as default};
//# sourceMappingURL=AdminInviteCodesPage-DWzlldIt.js.map
