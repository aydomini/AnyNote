const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotesPage-C9jK8LRD.js","assets/markdown-vendor-CHUou9Sa.js","assets/react-vendor-9esfqqE9.js","assets/index-Dt62Q5Mp.js","assets/zustand-vendor-CzPTHOhB.js","assets/index-D7p6glqb.css","assets/crypto-DgWI3rvl.js","assets/device-C8OUsEf4.js","assets/crypto-vendor-DLELI0UM.js","assets/index-DmPTVDsj.js","assets/Toast-ClRAtSG1.js","assets/NotesPage-B3pgEpGO.css"])))=>i.map(i=>d[i]);
import{u as Y,a as Z,_ as ee,b as p}from"./index-Dt62Q5Mp.js";import{j as e}from"./markdown-vendor-CHUou9Sa.js";import{u as re,r as a,L as te}from"./react-vendor-9esfqqE9.js";import{E as se}from"./index-C-GWJ8ez.js";import{c as L}from"./crypto-DgWI3rvl.js";import{g as I,a as ae,s as oe}from"./device-C8OUsEf4.js";import{u as le}from"./index-DmPTVDsj.js";import"./zustand-vendor-CzPTHOhB.js";import"./crypto-vendor-DLELI0UM.js";function ue(){const P=re(),R=Y(r=>r.login),{getResolvedTheme:V}=Z(),{t}=le();a.useEffect(()=>{ee(()=>import("./NotesPage-C9jK8LRD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))},[]);const[n,D]=a.useState(""),[u,F]=a.useState(""),[M,g]=a.useState(!1),[C,c]=a.useState(""),[f,b]=a.useState(""),[E,H]=a.useState(!1),[K,S]=a.useState(!1),l=t.login.about,[y,m]=a.useState(""),[v,k]=a.useState(""),O=r=>r.length>0&&r.length<12?(m(t.errors.emailTooShort),!1):r.length>32?(m(t.errors.emailTooLong),!1):r.length>=12&&!r.includes("@")?(m(t.errors.emailInvalidFormat),!1):(m(""),!0),W=r=>r.length>0&&r.length<12?(k(t.errors.passwordMinLength),!1):r.length>32?(k(t.errors.passwordMaxLength),!1):(k(""),!0),q=r=>{D(r),O(r)},U=r=>{F(r),W(r)},$=async r=>{var d,h,_,z,T;if(r.preventDefault(),c(""),!f){c(t.errors.turnstileRequired);return}g(!0);try{let o=L.getSalt(n);if(!o){const s=await p.getSalt(n);if(!s.success||!s.data){const N=((d=s.error)==null?void 0:d.code)==="TIMEOUT"?"网络请求超时，请检查网络连接后重试":((h=s.error)==null?void 0:h.message)||"无法获取加密密钥，请稍后重试";c(N),g(!1);return}o=s.data.salt}const x=await L.restore(u,n,o),G=I(),J=ae(),i=await p.login(n,x,G,J,f);if(!i.success||!i.data){let s="登录失败，请检查邮箱和密码";((_=i.error)==null?void 0:_.code)==="TIMEOUT"?s="网络请求超时，请检查网络连接后重试":((z=i.error)==null?void 0:z.code)==="NETWORK_ERROR"?s="网络连接失败，请检查网络后重试":(T=i.error)!=null&&T.message&&(s=i.error.message),c(s),g(!1);return}const{user:A,token:B,refresh_token:j,expires_in:w}=i.data;p.setToken(B,w?Date.now()+w*1e3:void 0),j&&p.setRefreshToken(j);const Q={...A,user_id:A.id};if(R(Q,B,j,w),E)try{const s=L.getEncryptionKey();if(!s)console.error("Failed to save encryption key: key is null");else{const N=I(),X=Date.now()+7*24*60*60*1e3;await oe(N,s,X)}}catch(s){console.error("Failed to save encryption key to IndexedDB:",s)}P("/notes")}catch(o){let x="登录失败，请稍后重试";o.name==="TypeError"&&o.message.includes("fetch")?x="网络连接失败，请检查您的网络连接":o.message&&(x=o.message),c(x),g(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"card relative overflow-hidden",children:[e.jsx("button",{type:"button",onClick:()=>S(!0),className:"absolute right-4 top-4 z-10 p-0.5 text-gray-400 transition-all hover:text-gray-600 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary-500/60 dark:text-gray-500 dark:hover:text-gray-300","aria-label":l.button,children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),K&&e.jsxs("div",{className:"absolute inset-0 z-20 flex flex-col rounded-2xl border border-white/60 bg-white/90 p-6 text-left shadow-[0_30px_80px_-35px_rgba(37,99,235,0.3)] backdrop-blur-xl dark:border-white/10 dark:bg-gray-900/90 dark:shadow-[0_30px_80px_-35px_rgba(96,165,250,0.4)]",children:[e.jsx("button",{type:"button",onClick:()=>S(!1),className:"absolute right-4 top-4 z-10 p-0.5 text-gray-400 transition-all hover:text-gray-600 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary-500/60 dark:text-gray-500 dark:hover:text-gray-300","aria-label":l.close,children:e.jsx("svg",{className:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"flex items-start gap-4 mb-4 pr-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/logo.svg",alt:"AnyNote",className:"w-12 h-12 flex-shrink-0 drop-shadow-lg"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[l.title,e.jsx("span",{className:"text-xs font-normal text-gray-500 dark:text-gray-400 bg-gray-200/50 dark:bg-gray-700/50 px-2 py-0.5 rounded-full",children:"v1.0.0"})]}),e.jsx("p",{className:"mt-1 text-sm leading-6 text-gray-600 dark:text-gray-300",children:l.subtitle})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:l.features.map((r,d)=>{const h=[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})}),e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"})}),e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"})}),e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"})})];return e.jsx("div",{className:"group rounded-xl border border-white/50 bg-white/55 p-4 shadow-lg ring-1 ring-white/40 transition-all duration-200 hover:shadow-xl hover:scale-[1.02] backdrop-blur-sm dark:border-white/10 dark:bg-white/10 dark:ring-white/5 dark:hover:bg-white/15",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-primary-100 text-primary-600 shadow-md ring-1 ring-primary-200/50 transition-transform group-hover:scale-110 dark:bg-primary-500/20 dark:text-primary-300 dark:ring-primary-400/30",children:h[d]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:r.title}),e.jsx("p",{className:"mt-1.5 text-xs leading-relaxed text-gray-600 dark:text-gray-300",children:r.description})]})]})},r.title)})})}),e.jsxs("div",{className:"mt-5 pt-4 border-t border-white/30 dark:border-white/10 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-300",children:[e.jsxs("span",{className:"inline-flex items-center gap-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-2.5 py-1 rounded-full font-medium",children:[e.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),"MIT License"]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"•"}),e.jsx("span",{children:l.footer})]}),e.jsxs("a",{href:"https://github.com/aydomini/AnyNote",target:"_blank",rel:"noreferrer",className:"flex items-center justify-center gap-2 w-full rounded-lg border border-primary-300 bg-primary-100 px-4 py-2.5 text-sm font-semibold text-primary-700 shadow-sm transition-all hover:bg-primary-200 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-primary-400/60 dark:border-primary-500/40 dark:bg-primary-500/20 dark:text-primary-200 dark:hover:bg-primary-500/30",children:[e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2C6.477 2 2 6.486 2 12.021c0 4.428 2.865 8.185 6.839 9.512.5.09.682-.218.682-.483 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.34-3.369-1.34-.455-1.159-1.11-1.468-1.11-1.468-.908-.62.069-.608.069-.608 1.004.071 1.532 1.033 1.532 1.033.892 1.531 2.341 1.088 2.91.832.091-.647.35-1.088.636-1.338-2.22-.254-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.254-.447-1.278.098-2.664 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844a9.53 9.53 0 012.503.337c1.909-1.296 2.748-1.026 2.748-1.026.546 1.386.202 2.41.1 2.664.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.694-4.566 4.943.359.309.679.919.679 1.852 0 1.336-.012 2.415-.012 2.743 0 .268.18.577.688.48A10.025 10.025 0 0022 12.021C22 6.486 17.523 2 12 2z"})}),e.jsx("span",{children:l.repoLabel}),e.jsx("svg",{className:"w-4 h-4 ml-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("img",{src:"/logo.svg",alt:"AnyNote",className:"w-16 h-16 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:t.login.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.login.securityNote})]})]}),C&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:C})}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.login.email}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"email",type:"email",value:n,onChange:r=>q(r.target.value),required:!0,autoComplete:"email",minLength:12,maxLength:32,className:`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${y?"border-2 border-red-500 dark:border-red-500":"border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}`,placeholder:t.login.emailPlaceholder}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[n.length,"/32"]})]}),y&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:y})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.login.password}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:"password",value:u,onChange:r=>{const d=r.target.value.replace(/\s/g,"");U(d)},onKeyDown:r=>{r.key===" "&&r.preventDefault()},required:!0,autoComplete:"current-password",minLength:12,maxLength:32,className:`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${v?"border-2 border-red-500 dark:border-red-500":"border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}`,placeholder:t.login.passwordPlaceholder}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[u.length,"/32"]})]}),v&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:v})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"rememberMe",type:"checkbox",checked:E,onChange:r=>H(r.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsx("label",{htmlFor:"rememberMe",className:"ml-2 text-sm text-gray-700 dark:text-gray-300 cursor-pointer select-none",children:t.login.rememberMe}),e.jsxs("div",{className:"group relative ml-2",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400 dark:text-gray-500 cursor-help",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"invisible group-hover:visible absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 text-xs text-white bg-gray-900 dark:bg-gray-700 rounded-lg shadow-lg w-48 z-10",children:[t.login.rememberMeTooltip,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900 dark:border-t-gray-700"})]})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(se,{siteKey:"0x4AAAAAAB7UqdxFxx0kLl6i",onSuccess:r=>b(r),onError:()=>b(""),onExpire:()=>b(""),options:{theme:V(),size:"flexible"}})}),e.jsx("button",{type:"submit",disabled:M||!f,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:M?t.login.loggingIn:t.login.loginButton})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.login.noAccount," ",e.jsx(te,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400",children:t.login.register})]})})]})})})}export{ue as default};
//# sourceMappingURL=LoginPage-BvXrlKzF.js.map
