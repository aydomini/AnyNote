var Za=Object.defineProperty;var Xa=(N,i,p)=>i in N?Za(N,i,{enumerable:!0,configurable:!0,writable:!0,value:p}):N[i]=p;var ut=(N,i,p)=>Xa(N,typeof i!="symbol"?i+"":i,p);import{j as e,r as Os,a as eo,b as Js,c as ro,d as to,M as pt}from"./markdown-vendor-CHUou9Sa.js";import{r as n,u as so}from"./react-vendor-9esfqqE9.js";import{u as bt,a as yt,i as kt,d as ao,b as C,c as oo,D as no,e as lo,f as io}from"./index-Dt62Q5Mp.js";import{c as L}from"./crypto-DgWI3rvl.js";import{c as Wr,g as co,b as xo,d as go}from"./device-C8OUsEf4.js";import{u as ho}from"./index-DmPTVDsj.js";import{u as mo,a as uo,T as po}from"./Toast-ClRAtSG1.js";import"./zustand-vendor-CzPTHOhB.js";import"./crypto-vendor-DLELI0UM.js";class ft extends n.Component{constructor(i){super(i),this.state={hasError:!1,error:null}}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,p){console.error("[MarkdownErrorBoundary] 捕获到 Markdown 渲染错误:",i,p),this.props.onError&&this.props.onError(i,p)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-2 border-yellow-400 dark:border-yellow-500/50 rounded-lg p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base font-bold text-yellow-900 dark:text-yellow-100 mb-2",children:"😔 笔记渲染遇到问题"}),e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200 mb-3 leading-relaxed",children:"您的设备可能不支持复杂的 Markdown 渲染（数学公式、代码高亮等）。"}),e.jsxs("div",{className:"bg-white dark:bg-gray-900/50 border border-yellow-300 dark:border-yellow-600/30 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"💡 建议解决方案："}),e.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1.5 list-disc list-inside",children:[e.jsxs("li",{children:["切换到",e.jsx("strong",{className:"text-blue-600 dark:text-blue-400",children:"编辑模式"}),"查看原始内容"]}),e.jsx("li",{children:"更新浏览器到最新版本（推荐 iOS 17+）"}),e.jsx("li",{children:"简化笔记内容，避免复杂的 LaTeX 公式"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),className:"text-sm px-4 py-2 rounded-lg bg-yellow-600 dark:bg-yellow-500 text-white font-medium hover:bg-yellow-700 dark:hover:bg-yellow-600 transition-colors shadow-sm",children:"🔄 重试渲染"}),e.jsx("a",{href:"#",onClick:i=>{i.preventDefault(),window.dispatchEvent(new CustomEvent("switchToEditMode"))},className:"text-sm px-4 py-2 rounded-lg bg-blue-600 dark:bg-blue-500 text-white font-medium hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-sm",children:"✏️ 切换到编辑模式"})]})]})]})}):this.props.children}}function bo({content:N,className:i=""}){const p=o=>{const j=o.split(`
`),z=[];let x=[],t=[],se=!1,me=[],Y=0;const P=()=>{x.length>0&&(z.push(e.jsx("ul",{className:"list-disc list-inside my-4 text-gray-700 dark:text-gray-100 space-y-1",children:x.map((D,R)=>e.jsx("li",{className:"text-base leading-relaxed ml-4",dangerouslySetInnerHTML:{__html:v(D)}},R))},`ul-${Y++}`)),x=[]),t.length>0&&(z.push(e.jsx("ol",{className:"list-decimal list-inside my-4 text-gray-700 dark:text-gray-100 space-y-1",children:t.map((D,R)=>e.jsx("li",{className:"text-base leading-relaxed ml-4",dangerouslySetInnerHTML:{__html:v(D)}},R))},`ol-${Y++}`)),t=[])},fr=()=>{me.length>0&&(z.push(e.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-lg border border-gray-300 dark:border-gray-700 my-4 overflow-x-auto",children:e.jsx("code",{className:"text-sm text-gray-900 dark:text-gray-100 font-mono",children:me.join(`
`)})},`pre-${Y++}`)),me=[])};return j.forEach(D=>{if(D.startsWith("```")){se?(fr(),se=!1):(P(),se=!0);return}if(se){me.push(D);return}if(D.startsWith("#")){P();const R=D.match(/^(#{1,6})\s+(.+)$/);if(R){const ue=R[1].length,X=R[2],w=`h${ue}`,J=["text-3xl font-bold text-gray-900 dark:text-white mb-4 mt-2 leading-tight","text-2xl font-bold text-gray-900 dark:text-white mb-4 mt-6 pb-2 border-b border-gray-300 dark:border-gray-700 leading-snug","text-xl font-bold text-gray-900 dark:text-white mb-3 mt-5 leading-snug","text-lg font-bold text-gray-900 dark:text-white mb-2 mt-4 leading-normal","text-base font-bold text-gray-900 dark:text-white mb-2 mt-3 leading-normal","text-sm font-bold text-gray-900 dark:text-white mb-2 mt-2 leading-normal"];z.push(e.jsx(w,{className:J[ue-1],dangerouslySetInnerHTML:{__html:v(X)}},`h${ue}-${Y++}`))}return}if(D.match(/^[\*\-\+]\s+/)){t=[];const R=D.replace(/^[\*\-\+]\s+/,"");x.push(R);return}if(D.match(/^\d+\.\s+/)){x=[];const R=D.replace(/^\d+\.\s+/,"");t.push(R);return}if(D.match(/^(\-{3,}|\*{3,}|_{3,})$/)){P(),z.push(e.jsx("hr",{className:"border-gray-300 dark:border-gray-600 my-6"},`hr-${Y++}`));return}if(D.startsWith(">")){P();const R=D.replace(/^>\s*/,"");z.push(e.jsx("blockquote",{className:"border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-500/5 pl-4 pr-4 py-2 my-4 italic text-gray-700 dark:text-gray-300",children:e.jsx("p",{dangerouslySetInnerHTML:{__html:v(R)}})},`quote-${Y++}`));return}if(D.trim()===""){P();return}P(),z.push(e.jsx("p",{className:"text-base text-gray-700 dark:text-gray-100 mb-3 leading-relaxed",dangerouslySetInnerHTML:{__html:v(D)}},`p-${Y++}`))}),P(),fr(),z},v=o=>{let j=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return j=j.replace(/\*\*(.+?)\*\*/g,'<strong class="font-bold text-gray-900 dark:text-white">$1</strong>'),j=j.replace(/__(.+?)__/g,'<strong class="font-bold text-gray-900 dark:text-white">$1</strong>'),j=j.replace(/\*(.+?)\*/g,'<em class="italic text-gray-700 dark:text-gray-200">$1</em>'),j=j.replace(/_(.+?)_/g,'<em class="italic text-gray-700 dark:text-gray-200">$1</em>'),j=j.replace(/`(.+?)`/g,'<code class="text-sm text-pink-600 dark:text-pink-400 bg-gray-200 dark:bg-gray-800 px-1.5 py-0.5 rounded font-mono">$1</code>'),j=j.replace(/\[(.+?)\]\((.+?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 underline decoration-blue-600/30 dark:decoration-blue-400/30 hover:decoration-blue-600 dark:hover:decoration-blue-400 transition-colors">$1</a>'),j},_=p(N);return e.jsx("div",{className:`simple-markdown ${i}`,children:_.length>0?_:e.jsx("p",{className:"text-base text-gray-500 dark:text-gray-400 italic",children:"暂无内容"})})}async function Qs(N){const i=new TextEncoder().encode(N),p=await crypto.subtle.digest("SHA-1",i);return Array.from(new Uint8Array(p)).map(o=>o.toString(16).padStart(2,"0")).join("").toUpperCase()}async function yo(N){try{const i=await Qs(N),p=i.substring(0,5),v=i.substring(5),_=await fetch(`https://api.pwnedpasswords.com/range/${p}`,{method:"GET"});if(!_.ok)throw new Error(`HIBP API error: ${_.status}`);const j=(await _.text()).split(`\r
`);for(const z of j){const[x,t]=z.split(":");if(x===v)return parseInt(t,10)}return 0}catch(i){throw console.error("Password breach check failed:",i),i}}async function ko(N){const i=await yo(N);let p;return i===0?p="safe":i<10?p="low":i<100?p="medium":i<1e4?p="high":p="critical",{breached:i>0,count:i,severity:p}}const Ks=new Map,fo=7*24*60*60*1e3;async function vo(N){const i=await Qs(N),p=Ks.get(i);if(p&&Date.now()-p.timestamp<fo)return p.result;const v=await ko(N);return Ks.set(i,{result:v,timestamp:Date.now()}),v}class qs{constructor(i=200){ut(this,"maxSize");ut(this,"cache");this.maxSize=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const p=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,p),p}set(i,p){if(this.cache.has(i)&&this.cache.delete(i),this.cache.size>=this.maxSize){const v=this.cache.keys().next().value;v!==void 0&&this.cache.delete(v)}this.cache.set(i,p)}has(i){return this.cache.has(i)}delete(i){this.cache.delete(i)}clear(){this.cache.clear()}size(){return this.cache.size}capacity(){return this.maxSize}}function Gs(N,i){const p=N.split(`
`),v=i.split(`
`),_=wo(p,v),o=new Set(_.map(se=>`${se.localIndex}-${se.serverIndex}`)),j=[],z=[];let x=0,t=0;for(;x<p.length||t<v.length;)if(o.has(`${x}-${t}`))j.push({lineNumber:x+1,content:p[x],type:"same"}),z.push({lineNumber:t+1,content:v[t],type:"same"}),x++,t++;else{const me=_.some(P=>P.localIndex===x),Y=_.some(P=>P.serverIndex===t);!me&&x<p.length?(j.push({lineNumber:x+1,content:p[x],type:"added"}),x++):!Y&&t<v.length?(z.push({lineNumber:t+1,content:v[t],type:"removed"}),t++):x<p.length&&t<v.length?(j.push({lineNumber:x+1,content:p[x],type:"modified"}),z.push({lineNumber:t+1,content:v[t],type:"modified"}),x++,t++):x<p.length?(j.push({lineNumber:x+1,content:p[x],type:"added"}),x++):t<v.length&&(z.push({lineNumber:t+1,content:v[t],type:"removed"}),t++)}return{localLines:j,serverLines:z}}function wo(N,i){const p=N.length,v=i.length,_=Array(p+1).fill(0).map(()=>Array(v+1).fill(0));for(let x=1;x<=p;x++)for(let t=1;t<=v;t++)N[x-1]===i[t-1]?_[x][t]=_[x-1][t-1]+1:_[x][t]=Math.max(_[x-1][t],_[x][t-1]);const o=[];let j=p,z=v;for(;j>0&&z>0;)N[j-1]===i[z-1]?(o.unshift({localIndex:j-1,serverIndex:z-1}),j--,z--):_[j-1][z]>_[j][z-1]?j--:z--;return o}function Do(){var js,Ns,Cs,Ls,Ss,Ms,zs,Ps,_s,Ts,Es,Bs,Ds,$s,As,Is,Ws,Fs,Hs,Rs,Vs,Us;const N=so(),{user:i,token:p,logout:v}=bt(),{theme:_,language:o,setTheme:j,setLanguage:z,itemsPerPage:x}=yt(),{t}=ho(),{confirm:se,ConfirmDialog:me}=mo(),{toast:Y,showToast:P,hideToast:fr}=uo(),D=n.useRef(new qs(200)),R=n.useRef(new qs(200)),[ue,X]=n.useState([]),[w,J]=n.useState(null),[y,ae]=n.useState(""),[pe,ce]=n.useState(""),[W,ee]=n.useState([]),[V,be]=n.useState(""),F=n.useCallback((r,s={})=>se({title:s.title??t.common.confirm,description:r,confirmLabel:s.confirmLabel??t.common.continue,cancelLabel:s.cancelLabel??t.common.cancel,variant:s.variant??"danger"}),[se,t]),[Be,vt]=n.useState(null),[Ys,qe]=n.useState(!1),[Ge,Ne]=n.useState([]),[T,xe]=n.useState(null),[A,Qe]=n.useState(""),[K,Ye]=n.useState(""),[H,De]=n.useState(""),[G,Ze]=n.useState(""),[$e,wt]=n.useState(null),[Zs,Xe]=n.useState(!1),[jt,Nt]=n.useState(!1),[Fr,Xs]=n.useState(16),[Hr,ea]=n.useState(!0),[Rr,ra]=n.useState(!0),[Vr,ta]=n.useState(!0),[Ur,sa]=n.useState(!0),[E,er]=n.useState("notes"),[U,Ae]=n.useState("edit"),[ge,vr]=n.useState("preview"),[aa,le]=n.useState(!0),[q,O]=n.useState(!1),[Ct,h]=n.useState(""),[ye,wr]=n.useState(!1),[oa,Lt]=n.useState(!1),[Or,Ie]=n.useState(!1),[rr,Jr]=n.useState(!1),[St,We]=n.useState(!1),[na,jr]=n.useState(!1),[Kr,Mt]=n.useState(""),[tr,qr]=n.useState(""),[sr,zt]=n.useState(!1),[Pt,he]=n.useState(""),[ar,de]=n.useState(!1),[I,Nr]=n.useState(null),[_t,Tt]=n.useState(!1),[ke,Et]=n.useState(""),[fe,Bt]=n.useState(""),[or,Dt]=n.useState(""),[nr,$t]=n.useState(""),[ve,Cr]=n.useState(1),[we,Lr]=n.useState(1),[Ce,Sr]=n.useState("client"),[Le,Mr]=n.useState("client"),[Se,At]=n.useState(0),[Me,It]=n.useState(0),[Wt,la]=n.useState(""),[Ft,Ht]=n.useState(15),lr=n.useRef(null),[da,dr]=n.useState(!1),[g,ir]=n.useState(null),[ia,Rt]=n.useState(!1),[zr,Gr]=n.useState(""),[Vt,Fe]=n.useState(""),[He,Qr]=n.useState(!1),[ca,Ut]=n.useState(!1),[Yr,Pr]=n.useState(!1),[Zr,jo]=n.useState({current:0,total:0}),[Xr,Re]=n.useState({current:0,total:0}),[et,ze]=n.useState(null),Ve=n.useRef(null),[rt,Ot]=n.useState(!1),[_r,tt]=n.useState([]),[Jt,Kt]=n.useState(3),[qt,st]=n.useState(!1),[Gt,Pe]=n.useState(""),[Qt,at]=n.useState(!1),[ot,xa]=n.useState(new Set),[Yt,Zt]=n.useState(new Set),[Xt,Tr]=n.useState(""),[nt,es]=n.useState(null),[ga,ha]=n.useState(""),[ma,lt]=n.useState(!1),[rs,dt]=n.useState(""),[ts,it]=n.useState(""),[ss,No]=n.useState(!1),[as,cr]=n.useState(""),[ua,ct]=n.useState(!1),[xr,gr]=n.useState(""),[os,Er]=n.useState(null),[Z,B]=n.useState("saved"),re=n.useRef(Date.now()),_e=n.useRef(null),[ns,Br]=n.useState(!1),hr=n.useRef(null),xt=n.useCallback(()=>{if(hr.current!==null)return hr.current;const r=navigator.userAgent;if(!(/iPad|iPhone|iPod/.test(r)&&!window.MSStream))return hr.current=!1,!1;const a=r.match(/OS (\d+)_/);if(a&&a[1]){const l=parseInt(a[1],10);return hr.current=l<=16,l<=16}return hr.current=!1,!1},[]),mr=n.useCallback(async r=>{const s=`${r.id}-${r.updated_at}`,a=D.current,l=a.get(s);if(l)return{...r,content:l.content,tags:l.tags};try{const d=await L.decrypt({ciphertext:r.encrypted_content,iv:r.iv,algorithm:"AES-256-GCM"},!1);try{const c=JSON.parse(d);if(typeof c=="object"&&c!==null&&"content"in c){const u=typeof c.content=="string"?c.content:typeof c.content=="object"?JSON.stringify(c.content):String(c.content),b=Array.isArray(c.tags)?c.tags:[];return a.set(s,{content:u,tags:b}),{...r,content:u,tags:b}}const m=typeof c=="string"?c:JSON.stringify(c);return a.set(s,{content:m,tags:[]}),{...r,content:m,tags:[]}}catch{const m=typeof d=="string"?d:JSON.stringify(d);return a.set(s,{content:m,tags:[]}),{...r,content:m,tags:[]}}}catch(d){return console.error("[decryptNote] 解密笔记失败:",d),{...r,content:t.errors.decryptFailed,tags:[]}}},[t]);n.useEffect(()=>{(async()=>{{qr(lo);return}})()},[i==null?void 0:i.encrypted_nickname,i==null?void 0:i.nickname_iv,L.isInitialized()]);const Ue=500,Te=n.useCallback(async(r=1,s=x)=>{try{if(le(!0),kt()){const d=ao.map(c=>({...c,content:c.encrypted_content,tags:c.tags||[]}));X(d),At(d.length),Sr("client"),le(!1);return}const a=await C.getNotesCount();if(!a.success||!a.data){h(t.errors.loadNotesFailed),le(!1);return}const l=a.data.total;if(At(l),l<=Ue){const d=await C.getNotes(l||1e3,0);if(!d.success||!d.data){h(t.errors.loadNotesFailed),le(!1);return}if(d.data.quota){vt(d.data.quota);const u=`quota-dismissed-notes-${i.user_id}`,b=localStorage.getItem(u);qe(!!b)}const m=(await Promise.all(d.data.notes.map(u=>mr(u)))).map(u=>({...u,content:typeof u.content=="string"?u.content:JSON.stringify(u.content),tags:Array.isArray(u.tags)?u.tags:[]}));X(m),Sr("client")}else{const d=(r-1)*s,c=await C.getNotes(s,d);if(!c.success||!c.data){h(t.errors.loadNotesFailed),le(!1);return}if(c.data.quota){vt(c.data.quota);const b=`quota-dismissed-notes-${i.user_id}`,f=localStorage.getItem(b);qe(!!f)}const u=(await Promise.all(c.data.notes.map(b=>mr(b)))).map(b=>({...b,content:typeof b.content=="string"?b.content:JSON.stringify(b.content),tags:Array.isArray(b.tags)?b.tags:[]}));X(u),Sr("server")}}catch(a){h(a.message||t.errors.loadNotesFailed)}finally{le(!1)}},[t,x,mr]),ur=n.useCallback(async r=>{const s=`${r.id}-${r.updated_at}`,a=R.current,l=a.get(s);if(l)return{...r,site:l.site,username:l.username,password:l.password,notes:l.notes};try{const d=await L.decrypt({ciphertext:r.encrypted_site,iv:r.iv,algorithm:"AES-256-GCM"},!1);try{const c=JSON.parse(d),m={site:String(c.site||""),username:String(c.username||""),password:String(c.password||""),notes:String(c.notes||"")};return a.set(s,m),{...r,...m}}catch{const c=await L.decrypt({ciphertext:r.encrypted_username,iv:r.iv,algorithm:"AES-256-GCM"},!1),m=await L.decrypt({ciphertext:r.encrypted_password,iv:r.iv,algorithm:"AES-256-GCM"},!1);let u="";if(r.encrypted_notes)try{u=await L.decrypt({ciphertext:r.encrypted_notes,iv:r.iv,algorithm:"AES-256-GCM"},!1)}catch{}const b={site:d,username:c,password:m,notes:u};return a.set(s,b),{...r,...b}}}catch(d){return console.error("[decryptPassword] 解密密码失败:",d),{...r,site:"[解密失败]",username:"[解密失败]",password:"[解密失败]",notes:""}}},[]),Ee=n.useCallback(async(r=1,s=x)=>{try{if(kt()){const d=oo.map(c=>({...c,site:c.encrypted_site,username:c.encrypted_username,password:c.encrypted_password,notes:c.encrypted_notes}));Ne(d),It(d.length),Mr("client");return}const a=await C.getPasswordsCount();if(!a.success||!a.data){h(t.errors.loadPasswordsFailed);return}const l=a.data.total;if(It(l),l<=Ue){const d=await C.getPasswords(l||1e3,0);if(!d.success||!d.data){h(t.errors.loadPasswordsFailed);return}if(d.data.quota){wt(d.data.quota);const m=`quota-dismissed-passwords-${i.user_id}`,u=localStorage.getItem(m);Xe(!!u)}const c=await Promise.all(d.data.passwords.map(m=>ur(m)));Ne(c),Mr("client")}else{const d=(r-1)*s,c=await C.getPasswords(s,d);if(!c.success||!c.data){h(t.errors.loadPasswordsFailed);return}if(c.data.quota){wt(c.data.quota);const u=`quota-dismissed-passwords-${i.user_id}`,b=localStorage.getItem(u);Xe(!!b)}const m=await Promise.all(c.data.passwords.map(u=>ur(u)));Ne(m),Mr("server")}}catch(a){h(a.message||t.errors.loadPasswordsFailed)}},[t,x,ur]);n.useEffect(()=>(C.setUnauthorizedHandler(r=>{let s="";r==="SESSION_INVALID"?s=t.errors.sessionRevokedTitle:s=t.errors.sessionExpiredTitle,la(s),Ht(15);let a=15;lr.current=setInterval(()=>{a-=1,Ht(a),a<=0&&(lr.current&&clearInterval(lr.current),ls())},1e3)}),()=>{lr.current&&clearInterval(lr.current)}),[v,N,t]);const ls=n.useCallback(async()=>{L.clear(),await Wr(),v(),N("/login")},[v,N]);n.useEffect(()=>{(async()=>{{Te(),Ee();return}})()},[]),n.useEffect(()=>{if(!L.isInitialized())return;const s=setInterval(async()=>{if(L.isInitialized())try{(await C.heartbeat()).success}catch(a){console.error("[心跳检测] 失败",a)}},6e4);return()=>{clearInterval(s)}},[L.isInitialized()]),n.useEffect(()=>{if(!L.isInitialized())return;const r=60*60*1e3;let s;const a=()=>{s&&clearTimeout(s),s=setTimeout(async()=>{D.current.clear(),R.current.clear(),L.clear(),await Wr(),v(),N("/login"),console.log("[安全] 已自动登出（60分钟无活动）")},r)},l=["mousedown","keydown","scroll","touchstart"];return l.forEach(d=>window.addEventListener(d,a)),a(),()=>{s&&clearTimeout(s),l.forEach(d=>window.removeEventListener(d,a))}},[L.isInitialized(),v,N]),n.useEffect(()=>{const r=()=>{w&&U==="preview"&&(Ae("edit"),console.log("[NotesPage] ErrorBoundary 触发切换到编辑模式"))};return window.addEventListener("switchToEditMode",r),()=>window.removeEventListener("switchToEditMode",r)},[w,U]),n.useEffect(()=>{if(_e.current&&clearTimeout(_e.current),!w||U!=="edit"||E!=="notes")return;const r=async()=>{!w||!y.trim()||U!=="edit"||await Dr(!0)},s=3e5;return _e.current=setTimeout(()=>{r()},s),()=>{_e.current&&clearTimeout(_e.current)}},[y,pe,w,U,E]);const ds=n.useCallback(()=>{Et(or)},[or]),is=n.useCallback(()=>{Bt(nr)},[nr]);n.useEffect(()=>{(async()=>{if(ke.trim()){if(Se>Ue&&Ce==="server"){le(!0);try{const s=await C.getNotes(Se||1e3,0);if(s.success&&s.data){const l=(await Promise.all(s.data.notes.map(d=>mr(d)))).map(d=>({...d,content:typeof d.content=="string"?d.content:JSON.stringify(d.content),tags:Array.isArray(d.tags)?d.tags:[]}));X(l),Sr("client")}}catch(s){h(s.message||t.errors.loadNotesFailed)}finally{le(!1)}}Cr(1)}else Se>Ue&&Ce==="client"&&Te(1,x),Cr(1)})()},[ke,Se,Ce,x,mr,t,Te]),n.useEffect(()=>{(async()=>{if(fe.trim()){if(Me>Ue&&Le==="server"){le(!0);try{const s=await C.getPasswords(Me||1e3,0);if(s.success&&s.data){const a=await Promise.all(s.data.passwords.map(l=>ur(l)));Ne(a),Mr("client")}}catch(s){h(s.message||t.errors.loadPasswordsFailed)}finally{le(!1)}}Lr(1)}else Me>Ue&&Le==="client"&&Ee(1,x),Lr(1)})()},[fe,Me,Le,x,ur,t,Ee]),n.useEffect(()=>{const r=async s=>{if(V.trim()){s.preventDefault(),s.returnValue="";return}if(w&&E==="notes"&&Z==="unsaved"){w&&y.trim()&&U==="edit"&&await Dr(!0),s.preventDefault(),s.returnValue="";return}i&&p&&(s.preventDefault(),s.returnValue="")};return window.addEventListener("beforeunload",r),()=>window.removeEventListener("beforeunload",r)},[w,E,Z,y,U,i,p,V]);const pa=async r=>{if(ns){console.log("[handleSelectNote] 正在渲染笔记，忽略新的点击");return}if((w==null?void 0:w.id)===r.id&&E==="notes"){if(V.trim()&&!await F(o==="zh-CN"?"标签输入框中有未生成的内容，返回后将丢失。是否继续？":"You have unsaved tag input. It will be lost if you go back. Continue?")||Z==="unsaved"&&y.trim()&&!await F(t.errors.unsavedChangesBack))return;J(null),ce(""),ae(""),ee([]),be(""),Ie(!1),B("saved"),Br(!1);return}if(!(V.trim()&&!await F(o==="zh-CN"?"标签输入框中有未生成的内容，切换笔记后将丢失。是否继续？":"You have unsaved tag input. It will be lost if you switch notes. Continue?"))&&!(w&&Z==="unsaved"&&y.trim()&&!await F(t.errors.unsavedChangesSwitch)))try{Br(!0),h(""),er("notes"),xe(null),Ie(!0),Ae("preview"),B("saved"),re.current=r.updated_at*1e3;const s=xt()?300:0;let a,l;try{if(typeof r.content=="object"&&r.content!==null){const d=r.content;"content"in d&&typeof d.content=="string"?(a=d.content,l=Array.isArray(d.tags)?d.tags:[]):(a=JSON.stringify(r.content),l=[])}else a=String(r.content||""),l=Array.isArray(r.tags)?r.tags:[]}catch(d){console.error("[handleSelectNote] 内容类型转换失败",d),a="",l=[]}setTimeout(()=>{J({...r,content:a,tags:l}),ce(r.title||""),be(""),setTimeout(()=>{try{ae(a),ee(l)}catch(d){console.error("[handleSelectNote] 设置笔记内容失败",d),h("笔记渲染失败，内容过于复杂。请尝试编辑模式查看。")}finally{setTimeout(()=>Br(!1),500)}},s)},s)}catch(s){console.error("[handleSelectNote] 选择笔记失败",s),h("加载笔记失败，请重试"),Br(!1)}},ba=async()=>{const r=String(y||"");V.trim()&&!await F(o==="zh-CN"?"标签输入框中有未生成的内容，创建新笔记后将丢失。是否继续？":"You have unsaved tag input. It will be lost if you create a new note. Continue?")||w&&Z==="unsaved"&&r.trim()&&!await F(t.errors.unsavedChangesNew)||(er("notes"),J(null),ce(""),ae(""),ee([]),be(""),Ie(!0),xe(null),h(""),Ae("edit"),B("saved"),re.current=0)},ya=()=>{const r=`quota-dismissed-notes-${i.user_id}`;localStorage.setItem(r,"true"),qe(!0)},ka=()=>{const r=`quota-dismissed-passwords-${i.user_id}`;localStorage.setItem(r,"true"),Xe(!0)},Dr=async(r=!1)=>{var l,d,c,m,u;if(q){console.warn("[handleSaveNote] 保存中，忽略重复请求");return}const s=String(y||"");if(!s.trim()){r||h(t.errors.noteContentEmpty);return}let a=[...W];V.trim()&&!a.includes(V.trim())&&(a.push(V.trim()),ee(a),be(""));try{O(!0),r?B("saving"):h("");const b=await L.encrypt(JSON.stringify({content:s,tags:a}));if(w){const f=await C.updateNote(w.id,{title:pe||void 0,encrypted_content:b.ciphertext,iv:b.iv,version:w.version});if(!f.success||!f.data){if(((l=f.error)==null?void 0:l.code)==="VERSION_CONFLICT"){_e.current&&clearTimeout(_e.current);try{const S=await C.getNote(w.id);if(S.success&&S.data){const k=S.data,M=await L.decrypt({ciphertext:k.encrypted_content,iv:k.iv,algorithm:"AES-256-GCM"});let $=M,oe=[];try{const ne=JSON.parse(M);typeof ne=="object"&&ne.content!==void 0&&($=ne.content,oe=ne.tags||[])}catch{}ir({noteId:w.id,localContent:y,localTitle:pe,localTags:W,localVersion:w.version,serverContent:$,serverTitle:k.title||"",serverTags:oe,serverVersion:k.version,serverEncryptedContent:k.encrypted_content,serverIv:k.iv,timestamp:Date.now()}),dr(!0),B("error")}}catch(S){console.error("Failed to fetch server version:",S),h(t.errors.saveNoteFailed+" (无法获取服务器版本)")}O(!1);return}if(((d=f.error)==null?void 0:d.code)==="NOTE_UPDATE_RATE_LIMIT"){const S=f.error.remainingSeconds||60,k=o==="zh-CN"?`${t.errors.rateLimitMessage}

${t.errors.rateLimitWait.replace("{seconds}",String(S))}`:`${t.errors.rateLimitMessage}

${t.errors.rateLimitWait.replace("{seconds}",String(S))}`;h(k),O(!1);return}r?(B("error"),console.error("Auto-save failed:",(c=f.error)==null?void 0:c.message)):h(((m=f.error)==null?void 0:m.message)||t.errors.saveNoteFailed),O(!1);return}X(S=>S.map(k=>k.id===w.id?{...f.data,content:s,tags:a}:k)),J({...f.data,content:s,tags:a}),r?(B("saved"),re.current=Date.now(),P(t.common.autoSaved,{variant:"info",duration:2e3})):(B("saved"),re.current=Date.now(),P(t.common.saved,{variant:"success"}))}else{if(r){O(!1);return}const f=await C.createNote({title:pe||void 0,encrypted_content:b.ciphertext,iv:b.iv});if(!f.success||!f.data){h(((u=f.error)==null?void 0:u.message)||t.errors.createNoteFailed),O(!1);return}const S={...f.data,content:s,tags:a};X(k=>[S,...k]),J(S),B("saved"),re.current=Date.now(),P(t.common.saved,{variant:"success"})}}catch(b){r?(B("error"),console.error("Auto-save error:",b)):h(b.message||t.errors.saveNoteFailed)}finally{O(!1)}},fa=async()=>{var r;if(g)try{O(!0);const s=await L.encrypt(JSON.stringify({content:g.localContent,tags:g.localTags})),a=await C.updateNote(g.noteId,{title:g.localTitle||void 0,encrypted_content:s.ciphertext,iv:s.iv,version:g.serverVersion});if(a.success&&a.data){const l={...a.data,content:g.localContent,tags:g.localTags};X(d=>d.map(c=>c.id===g.noteId?l:c)),J(l),ae(g.localContent),ce(g.localTitle),ee(g.localTags),dr(!1),ir(null),B("saved"),re.current=Date.now(),P(((r=t.conflicts)==null?void 0:r.useLocalSuccess)||"已使用你的版本覆盖服务器",{variant:"success"})}else h(t.errors.saveNoteFailed)}catch(s){h(t.errors.saveNoteFailed+": "+s.message)}finally{O(!1)}},va=async()=>{var s,a;!g||!await F(((s=t.conflicts)==null?void 0:s.confirmUseServer)||`确定要放弃你的修改吗？

你的本地版本已备份到浏览器存储中，稍后可以恢复。`,{confirmLabel:t.common.confirm})||(ae(g.serverContent),ce(g.serverTitle),ee(g.serverTags),J({...w,content:g.serverContent,title:g.serverTitle,tags:g.serverTags,version:g.serverVersion,encrypted_content:g.serverEncryptedContent,iv:g.serverIv}),X(l=>l.map(d=>d.id===g.noteId?{...d,content:g.serverContent,title:g.serverTitle,tags:g.serverTags,version:g.serverVersion}:d)),dr(!1),ir(null),B("saved"),re.current=Date.now(),h(((a=t.conflicts)==null?void 0:a.useServerInfo)||"已切换到服务器版本。你在当前设备的修改已被放弃。"),setTimeout(()=>h(""),5e3))},[wa,$r]=n.useState(!1),[je,pr]=n.useState(""),ja=()=>{g&&(pr(g.localContent),$r(!0))},Na=async()=>{var r;if(!g||!je.trim()){h(t.errors.noteContentEmpty);return}try{O(!0);const s=await L.encrypt(JSON.stringify({content:je,tags:g.localTags})),a=await C.updateNote(g.noteId,{title:g.localTitle||void 0,encrypted_content:s.ciphertext,iv:s.iv,version:g.serverVersion});if(a.success&&a.data){const l={...a.data,content:je,tags:g.localTags};X(d=>d.map(c=>c.id===g.noteId?l:c)),J(l),ae(je),ce(g.localTitle),ee(g.localTags),dr(!1),ir(null),$r(!1),pr(""),B("saved"),re.current=Date.now(),P(((r=t.conflicts)==null?void 0:r.applyMergeSuccess)||"合并成功并已保存",{variant:"success"})}else h(t.errors.saveNoteFailed)}catch(s){h(t.errors.saveNoteFailed+": "+s.message)}finally{O(!1)}},Ca=async()=>{var r;je!==(g==null?void 0:g.localContent)&&!await F(((r=t.conflicts)==null?void 0:r.confirmCancelMerge)||"确定要放弃合并吗？未保存的修改将会丢失。",{variant:"danger"})||($r(!1),pr(""))},La=async()=>{if(!(!w||!await F(t.notes.deleteConfirm,{confirmLabel:t.common.delete})))try{if(!(await C.deleteNote(w.id)).success){h(t.errors.deleteNoteFailed);return}X(a=>a.filter(l=>l.id!==w.id)),J(null),ce(""),ae(""),ee([]),Ae("edit"),P(t.notes.deleteSuccess,{variant:"success"})}catch(s){h(s.message||t.errors.deleteNoteFailed)}},Sa=async r=>{if((T==null?void 0:T.id)===r.id&&E==="passwords"){if(ar&&(A.trim()||K.trim()||H.trim()||G.trim())&&!await F(t.errors.unsavedChangesBack))return;xe(null),Qe(""),Ye(""),De(""),Ze(""),de(!1),Nr(null);return}T&&ar&&(A.trim()||K.trim()||H.trim()||G.trim())&&!await F(t.errors.unsavedChangesSwitch)||(er("passwords"),xe(r),Qe(r.site||""),Ye(r.username||""),De(r.password||""),Ze(r.notes||""),vr("preview"),J(null),Ie(!1),h(""),de(!1),Nr(null))},cs=async()=>{T&&ar&&(A.trim()||K.trim()||H.trim()||G.trim())&&!await F(t.errors.unsavedChangesNew)||(er("passwords"),xe(null),Qe(""),Ye(""),De(""),Ze(""),vr("edit"),J(null),Ie(!1),h(""),wr(!1),de(!1),Nr(null))},Ma=()=>{if(!Hr&&!Rr&&!Vr&&!Ur){h(t.passwords.generator.error);return}const r={uppercase:Hr,lowercase:Rr,digits:Vr,symbols:Ur},s=L.generatePassword(Fr,r);De(s),wr(!0),Nt(!1),h("")},za=async()=>{if(!H){h(o==="zh-CN"?"请先输入密码":"Please enter a password first");return}Tt(!0),h("");try{const r=await vo(H);Nr(r)}catch(r){console.error("密码泄露检测失败:",r),h(o==="zh-CN"?"检测失败，请稍后重试":"Check failed, please try again later")}finally{Tt(!1)}},Pa=async()=>{var r,s,a;if(q){console.warn("[handleSavePassword] 保存中，忽略重复请求");return}if(!A.trim()){h(t.errors.passwordSiteEmpty);return}try{O(!0),h("");const l={site:A,username:K||"",password:H||"",notes:G||""},d=await L.encrypt(JSON.stringify(l));if(T){const c=await C.updatePassword(T.id,{encrypted_site:d.ciphertext,encrypted_username:d.ciphertext,encrypted_password:d.ciphertext,encrypted_notes:d.ciphertext,iv:d.iv,version:T.version});if(!c.success||!c.data){if(((r=c.error)==null?void 0:r.code)==="PASSWORD_UPDATE_RATE_LIMIT"){const u=c.error.remainingSeconds||60,b=o==="zh-CN"?`${t.errors.rateLimitMessage}

${t.errors.rateLimitWait.replace("{seconds}",String(u))}`:`${t.errors.rateLimitMessage}

${t.errors.rateLimitWait.replace("{seconds}",String(u))}`;h(b),O(!1);return}h(((s=c.error)==null?void 0:s.message)||t.errors.saveNoteFailed),O(!1);return}const m={...c.data,site:A,username:K||"",password:H||"",notes:G||""};Ne(u=>u.map(b=>b.id===T.id?m:b)),xe(m),de(!1),P(t.common.saved,{variant:"success"})}else{const c=await C.createPassword({encrypted_site:d.ciphertext,encrypted_username:d.ciphertext,encrypted_password:d.ciphertext,encrypted_notes:d.ciphertext,iv:d.iv});if(!c.success||!c.data){h(((a=c.error)==null?void 0:a.message)||t.errors.createNoteFailed),O(!1);return}const m={...c.data,site:A,username:K||"",password:H||"",notes:G||""};Ne(u=>[m,...u]),xe(m),de(!1),P(t.common.saved,{variant:"success"})}}catch(l){h(l.message||t.errors.saveNoteFailed)}finally{O(!1)}},_a=async()=>{if(!(!T||!await F(t.passwords.deleteConfirm,{confirmLabel:t.common.delete})))try{if(!(await C.deletePassword(T.id)).success){h(t.errors.deleteNoteFailed);return}Ne(a=>a.filter(l=>l.id!==T.id)),cs(),P(t.passwords.deleteSuccess,{variant:"success"})}catch(s){h(s.message||t.errors.deleteNoteFailed)}},br=async(r,s)=>{try{await navigator.clipboard.writeText(r);const a=s===t.passwords.username?t.passwords.usernameCopied:t.passwords.passwordCopied;P(a,{variant:"success",duration:2e3})}catch{P(t.errors.copyFailed,{variant:"error"})}},xs=r=>{try{const s=new URL(r);return s.protocol==="http:"||s.protocol==="https:"}catch{return/^([a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/.test(r)}},gs=r=>{try{return new URL(r),r}catch{return`https://${r}`}},hs=(r,s)=>{if(s&&s.startsWith("#")){r.preventDefault();const a=s.substring(1),l=document.getElementById(a);if(l)l.scrollIntoView({behavior:"smooth",block:"start"});else{const d=decodeURIComponent(a),c=document.querySelectorAll("h1, h2, h3, h4, h5, h6");for(const m of c)if(m.textContent===d||m.id===d){m.scrollIntoView({behavior:"smooth",block:"start"});break}}}},Ta=async r=>{try{await navigator.clipboard.writeText(r),Lt(!0),P(t.common.copied,{variant:"success",duration:2e3}),setTimeout(()=>Lt(!1),2e3)}catch(s){console.error("复制失败:",s),P(t.errors.copyFailed,{variant:"error"})}},Ea=({children:r,className:s})=>{const[a,l]=n.useState(!1),d=m=>typeof m=="string"?m:typeof m=="number"?String(m):Array.isArray(m)?m.map(d).join(""):m&&typeof m=="object"&&"props"in m?d(m.props.children):"",c=d(r);return e.jsxs("div",{className:"relative group",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[e.jsx("pre",{className:`bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg border border-gray-300 dark:border-gray-700 my-4 overflow-hidden ${s||""}`,children:r}),e.jsx("button",{onClick:()=>Ta(c),className:`absolute top-2 right-2 px-3 py-1.5 text-xs rounded-md bg-gray-700/80 hover:bg-gray-600 dark:bg-gray-600/80 dark:hover:bg-gray-500 text-white transition-all flex items-center gap-1.5 backdrop-blur-sm ${a?"opacity-100":"opacity-0"}`,title:t.common.copy,children:oa?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t.common.copied]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),t.common.copy]})})]})},Oe=n.useMemo(()=>({h1:({node:r,...s})=>e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4 mt-2 leading-tight",...s}),h2:({node:r,...s})=>e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 mt-6 pb-2 border-b border-gray-300 dark:border-gray-700 leading-snug",...s}),h3:({node:r,...s})=>e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-3 mt-5 leading-snug",...s}),h4:({node:r,...s})=>e.jsx("h4",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2 mt-4 leading-normal",...s}),h5:({node:r,...s})=>e.jsx("h5",{className:"text-base font-bold text-gray-900 dark:text-white mb-2 mt-3 leading-normal",...s}),h6:({node:r,...s})=>e.jsx("h6",{className:"text-sm font-bold text-gray-900 dark:text-white mb-2 mt-2 leading-normal",...s}),p:({node:r,...s})=>e.jsx("p",{className:"text-base text-gray-700 dark:text-gray-100 mb-3 leading-relaxed",...s}),a:({node:r,href:s,...a})=>e.jsx("a",{className:"text-blue-600 dark:text-blue-400 underline decoration-blue-600/30 dark:decoration-blue-400/30 hover:decoration-blue-600 dark:hover:decoration-blue-400 transition-colors",onClick:l=>hs(l,s),target:s!=null&&s.startsWith("#")?void 0:"_blank",rel:s!=null&&s.startsWith("#")?void 0:"noopener noreferrer",href:s,...a}),strong:({node:r,...s})=>e.jsx("strong",{className:"font-bold text-gray-900 dark:text-white",...s}),em:({node:r,...s})=>e.jsx("em",{className:"italic text-gray-700 dark:text-gray-200",...s}),code:({node:r,inline:s,...a})=>s?e.jsx("code",{className:"text-sm text-pink-600 dark:text-pink-400 px-1.5 py-0.5 rounded font-mono inline-code-bg",...a}):e.jsx("code",{className:"block text-sm p-4 rounded-lg my-4 overflow-x-auto font-mono",...a}),pre:({node:r,children:s,...a})=>e.jsx(Ea,{...a,children:s}),blockquote:({node:r,...s})=>e.jsx("blockquote",{className:"border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-500/5 pl-4 pr-4 py-2 my-4 italic text-gray-700 dark:text-gray-300",...s}),ul:({node:r,...s})=>e.jsx("ul",{className:"list-disc list-inside my-4 text-gray-700 dark:text-gray-100 space-y-1",...s}),ol:({node:r,...s})=>e.jsx("ol",{className:"list-decimal list-inside my-4 text-gray-700 dark:text-gray-100 space-y-1",...s}),li:({node:r,...s})=>e.jsx("li",{className:"text-base text-gray-700 dark:text-gray-100 leading-relaxed ml-4",...s}),hr:({node:r,...s})=>e.jsx("hr",{className:"border-gray-300 dark:border-gray-600 my-6",...s}),table:({node:r,...s})=>e.jsx("table",{className:"border-collapse my-4 w-full text-gray-900 dark:text-gray-100",...s}),thead:({node:r,...s})=>e.jsx("thead",{className:"border-b-2 border-gray-300 dark:border-gray-600",...s}),th:({node:r,...s})=>e.jsx("th",{className:"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white font-semibold p-3 text-left border border-gray-300 dark:border-gray-700",...s}),td:({node:r,...s})=>e.jsx("td",{className:"p-3 border border-gray-300 dark:border-gray-700 text-gray-900 dark:text-gray-100",...s}),img:({node:r,...s})=>e.jsx("img",{className:"rounded-lg shadow-xl my-6 max-w-full",...s})}),[hs]),Ar=xt(),Je=n.useMemo(()=>Ar?[Os]:[Os,eo],[Ar]),Ke=n.useMemo(()=>Ar?[Js]:[ro,Js,to],[Ar]),Ba=n.useMemo(()=>{const r=String(y||`*${t.notes.previewPlaceholder}*`);return e.jsx(pt,{remarkPlugins:Je,rehypePlugins:Ke,components:Oe,children:r})},[y,Je,Ke,Oe,t.notes.previewPlaceholder]),Da=n.useMemo(()=>{const r=String(y||"*开始输入以查看预览...*");return e.jsx(pt,{remarkPlugins:Je,rehypePlugins:Ke,components:Oe,children:r})},[y,Je,Ke,Oe]),$a=n.useMemo(()=>{const s=String(y||`*${o==="zh-CN"?"暂无内容":"No content"}*`);return e.jsx(pt,{remarkPlugins:Je,rehypePlugins:Ke,components:Oe,children:s})},[y,Je,Ke,Oe,o]),Ir=async()=>{if(E==="notes"){if(w&&Z==="unsaved"&&y.trim()&&!await F(t.errors.unsavedChangesBack))return;J(null),ce(""),ae(""),ee([]),be(""),Ie(!1),Ae("edit"),Jr(!1),B("saved")}else{if(ar&&(A.trim()||K.trim()||H.trim()||G.trim())&&!await F(t.errors.unsavedChangesBack))return;xe(null),Qe(""),Ye(""),De(""),Ze(""),vr("preview"),de(!1)}},ms=async r=>{E!==r&&(E==="notes"&&r==="passwords"&&w&&Z==="unsaved"&&y.trim()&&!await F(t.errors.unsavedChangesBack)||E==="passwords"&&r==="notes"&&T&&ar&&(A.trim()||K.trim()||H.trim()||G.trim())&&!await F(t.errors.unsavedChangesBack)||er(r))},gt=n.useMemo(()=>{let r=ue;if(ke.trim()){const s=ke.toLowerCase();r=r.filter(a=>!!(a.title&&a.title.toLowerCase().includes(s)||a.content&&a.content.toLowerCase().includes(s)||a.tags&&a.tags.some(l=>l.toLowerCase().includes(s))))}return r},[ue,ke]),ht=n.useMemo(()=>{if(!fe.trim())return Ge;const r=fe.toLowerCase();return Ge.filter(s=>!!(s.site&&s.site.toLowerCase().includes(r)||s.username&&s.username.toLowerCase().includes(r)||s.notes&&s.notes.toLowerCase().includes(r)))},[Ge,fe]),yr=n.useMemo(()=>{if(Ce==="client"){const r=gt.length,s=Math.ceil(r/x),a=(ve-1)*x,l=a+x;return{items:gt.slice(a,l),totalItems:r,totalPages:s,currentPage:ve,hasNextPage:ve<s,hasPrevPage:ve>1}}else{const r=Math.ceil(Se/x);return{items:ue,totalItems:Se,totalPages:r,currentPage:ve,hasNextPage:ve<r,hasPrevPage:ve>1}}},[Ce,gt,ue,Se,ve,x]),kr=n.useMemo(()=>{if(Le==="client"){const r=ht.length,s=Math.ceil(r/x),a=(we-1)*x,l=a+x;return{items:ht.slice(a,l),totalItems:r,totalPages:s,currentPage:we,hasNextPage:we<s,hasPrevPage:we>1}}else{const r=Math.ceil(Me/x);return{items:Ge,totalItems:Me,totalPages:r,currentPage:we,hasNextPage:we<r,hasPrevPage:we>1}}},[Le,ht,Ge,Me,we,x]),us=({currentPage:r,totalPages:s,totalItems:a,onPageChange:l})=>{const[d,c]=n.useState(!1),[m,u]=n.useState(""),b=()=>{const S=parseInt(m);S>=1&&S<=s&&(l(S),c(!1),u(""))},f=o==="zh-CN"?{prev:"上一页",next:"下一页",total:`共 ${a} 条`,jump:"点击跳转到指定页"}:{prev:"Previous",next:"Next",total:`Total ${a}`,jump:"Click to jump to page"};return e.jsxs("div",{className:"flex items-center justify-center gap-1 py-1.5",children:[e.jsx("button",{onClick:()=>l(r-1),disabled:r===1,className:"p-1 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors",title:f.prev,children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),d?e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx("input",{type:"number",min:"1",max:s,value:m,onChange:S=>u(S.target.value),onKeyDown:S=>{S.key==="Enter"&&b(),S.key==="Escape"&&(c(!1),u(""))},className:"w-10 px-1 py-0.5 text-xs text-center border border-blue-500 rounded bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:r.toString(),autoFocus:!0}),e.jsx("button",{onClick:b,className:"px-1.5 py-0.5 text-xs font-medium text-white bg-blue-500 rounded hover:bg-blue-600",children:"GO"}),e.jsx("button",{onClick:()=>{c(!1),u("")},className:"px-1 py-0.5 text-xs font-medium text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200",children:"✕"})]}):e.jsxs("button",{onClick:()=>s>1&&c(!0),className:`px-1.5 py-0.5 text-xs font-medium text-slate-700 dark:text-slate-200 transition-colors ${s>1?"hover:text-blue-500 dark:hover:text-blue-400 cursor-pointer":"cursor-default"}`,title:s>1?f.jump:"",children:[r,"/",s]}),e.jsx("button",{onClick:()=>l(r+1),disabled:r===s,className:"p-1 rounded border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors",title:f.next,children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("div",{className:"w-px h-4 bg-slate-300 dark:bg-slate-600 mx-0.5"}),e.jsx("span",{className:"text-[11px] text-slate-600 dark:text-slate-400 whitespace-nowrap",children:f.total})]})},ps=r=>{const s=["bg-blue-500","bg-blue-500","bg-pink-500","bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-teal-500","bg-cyan-500","bg-indigo-500"];let a=0;for(let d=0;d<r.length;d++)a=r.charCodeAt(d)+((a<<5)-a);const l=Math.abs(a)%s.length;return s[l]},bs=r=>r.charAt(0).toUpperCase(),Aa=r=>{if(!r||!r.includes("@"))return r;const[s,a]=r.split("@");return!s||s.length===0?r:`${s.charAt(0)+"***"}@${a}`},ys=n.useCallback(r=>{const s=new Date(r),a=new Date;if(s.toDateString()===a.toDateString())return`${t.common.today} ${s.toLocaleTimeString(o==="zh-CN"?"zh-CN":"en-US",{hour:"2-digit",minute:"2-digit"})}`;const l=new Date(a);return l.setDate(l.getDate()-1),s.toDateString()===l.toDateString()?`${t.common.yesterday} ${s.toLocaleTimeString(o==="zh-CN"?"zh-CN":"en-US",{hour:"2-digit",minute:"2-digit"})}`:s.toLocaleString(o==="zh-CN"?"zh-CN":"en-US",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},[o,t]),ks=async()=>{if(!i||!zr.trim()){Fe(o==="zh-CN"?"请输入主密码":"Please enter master password");return}Qr(!0),Fe("");try{let r=L.getSalt(i.email);if(!r){const a=await C.getSalt(i.email);if(!a.success||!a.data){Fe(o==="zh-CN"?"无法获取加密密钥，请稍后重试":"Failed to get encryption key, please try again later"),Qr(!1);return}r=a.data.salt}if(await L.restore(zr,i.email,r),!(await C.heartbeat()).success)throw new Error("Session invalid");Rt(!1),Gr(""),Fe(""),await Te(),await Ee()}catch(r){console.error("Session restore failed:",r),Fe(o==="zh-CN"?"主密码错误或会话已过期，请重新登录":"Invalid password or session expired, please login again")}finally{Qr(!1)}},Ia=async()=>{Rt(!1),Gr(""),Fe(""),L.clear(),await Wr(),v(),N("/login")},Wa=()=>{Mt(""),he(""),jr(!0),We(!1)},fs=async()=>{var r,s,a,l;if(!(sr||!L.isInitialized()))try{zt(!0),he("");const d=Kr.trim();if(d){const{ciphertext:c,iv:m}=await L.encrypt(d),u=await C.updateNickname(c,m);if(!u.success){if(((a=u.error)==null?void 0:a.code)==="NICKNAME_RATE_LIMIT"){const f=u.error.remainingMinutes||60,S=o==="zh-CN"?`修改昵称过于频繁，请在 ${f} 分钟后再试`:`Nickname update too frequent, please try again in ${f} minutes`;he(S)}else he(((l=u.error)==null?void 0:l.message)||(o==="zh-CN"?"更新昵称失败":"Failed to update nickname"));return}const{updateUserNickname:b}=bt.getState();b({encrypted_nickname:c,nickname_iv:m}),qr(d)}else{const c=await C.updateNickname("","");if(!c.success){if(((r=c.error)==null?void 0:r.code)==="NICKNAME_RATE_LIMIT"){const u=c.error.remainingMinutes||60,b=o==="zh-CN"?`修改昵称过于频繁，请在 ${u} 分钟后再试`:`Nickname update too frequent, please try again in ${u} minutes`;he(b)}else he(((s=c.error)==null?void 0:s.message)||(o==="zh-CN"?"更新昵称失败":"Failed to update nickname"));return}const{updateUserNickname:m}=bt.getState();m(null),qr("")}P(o==="zh-CN"?"昵称更新成功":"Nickname updated successfully",{variant:"success"}),jr(!1),We(!1)}catch(d){he(d.message||(o==="zh-CN"?"更新昵称失败":"Failed to update nickname"))}finally{zt(!1)}},Fa=async()=>{try{await C.logout()}catch(r){console.error("Server logout failed:",r)}finally{L.clear(),await Wr(),v(),N("/login")}},Ha=async()=>{{cr(o==="zh-CN"?"🎭 Demo 模式下不支持数据导出功能":"🎭 Data export is not available in Demo mode");return}},vs=async()=>{if(!(!os||!xr))try{Pr(!0),ze(null),ct(!1);const r=await os.text(),s=JSON.parse(r);if(!s.encrypted||!s.ciphertext||!s.iv||!s.salt)throw new Error("Invalid encrypted file format");const a=Uint8Array.from(atob(s.ciphertext),f=>f.charCodeAt(0)),l=Uint8Array.from(atob(s.iv),f=>f.charCodeAt(0)),d=Uint8Array.from(atob(s.salt),f=>f.charCodeAt(0)),c=new TextEncoder,m=await window.crypto.subtle.importKey("raw",c.encode(xr),"PBKDF2",!1,["deriveBits","deriveKey"]),u=await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:d,iterations:6e5,hash:"SHA-256"},m,{name:"AES-GCM",length:256},!1,["decrypt"]);let b;try{const f=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:l},u,a),k=new TextDecoder().decode(f);b=JSON.parse(k)}catch{ze({type:"error",text:o==="zh-CN"?"解密失败，密码错误或文件损坏":"Decryption failed, wrong password or corrupted file"}),gr(""),Er(null),Pr(!1);return}await Ra(b),gr(""),Er(null)}catch(r){console.error("Decrypt and import failed:",r),ze({type:"error",text:t.dataManagement.importFailed}),Pr(!1)}},Ra=async r=>{try{if(C.setToken(p),!r.version||!r.notes||!r.passwords)throw new Error("Invalid file format");const s=r.notes.length+r.passwords.length;Re({current:0,total:s});let a=0,l=0;const d=new Set,c=await C.getNotes(1e4,0);if(c.success&&c.data)for(const k of c.data.notes)try{const M=await L.decrypt({ciphertext:k.encrypted_content,iv:k.iv,algorithm:"AES-256-GCM"},!1);let $=M,oe="";try{const Q=JSON.parse(M);typeof Q=="object"&&Q.content!==void 0&&($=typeof Q.content=="string"?Q.content:JSON.stringify(Q.content),oe=Array.isArray(Q.tags)?Q.tags.sort().join(","):"")}catch{}const te=`${String(k.title||"").trim()}|||${$.substring(0,200)}|||${oe}`;te!=="||||||"&&d.add(te)}catch{}for(let k=0;k<r.notes.length;k++){const M=r.notes[k];try{const $=String(M.content||""),oe=String(M.title||""),ne=Array.isArray(M.tags)?M.tags.sort().join(","):"",te=`${oe.trim()}|||${$.substring(0,200)}|||${ne}`;if(te!=="||||||"&&d.has(te)){l++,console.log("Skipped duplicate note:",M.title),Re({current:k+1,total:s});continue}const Q=Array.isArray(M.tags)?M.tags:[],ie=await L.encrypt(JSON.stringify({content:$,tags:Q}));(await C.createNote({title:M.title,encrypted_content:ie.ciphertext,iv:ie.iv})).success&&(a++,d.add(te))}catch($){console.error("Failed to import note:",$)}Re({current:k+1,total:s})}let m=0,u=0;const b=new Set,f=await C.getPasswords(1e4,0);if(f.success&&f.data)for(const k of f.data.passwords)try{const M=await L.decrypt({ciphertext:k.encrypted_site,iv:k.iv,algorithm:"AES-256-GCM"},!1);let $={};try{$=JSON.parse(M)}catch{const ie=M,mt=await L.decrypt({ciphertext:k.encrypted_username,iv:k.iv,algorithm:"AES-256-GCM"},!1);$={site:ie,username:mt}}const oe=($.site||"").trim().toLowerCase(),ne=($.username||"").trim().toLowerCase(),te=($.password||"").trim(),Q=`${oe}|||${ne}|||${te}`;Q!=="||||||"&&b.add(Q)}catch{}for(let k=0;k<r.passwords.length;k++){const M=r.passwords[k];try{const $=(M.site||"").trim().toLowerCase(),oe=(M.username||"").trim().toLowerCase(),ne=(M.password||"").trim(),te=`${$}|||${oe}|||${ne}`;if(te!=="||||||"&&b.has(te)){u++,console.log("Skipped duplicate password:",M.site,M.username),Re({current:r.notes.length+k+1,total:s});continue}const Q={site:M.site,username:M.username,password:M.password,notes:M.notes||""},ie=await L.encrypt(JSON.stringify(Q));(await C.createPassword({encrypted_site:ie.ciphertext,encrypted_username:ie.ciphertext,encrypted_password:ie.ciphertext,encrypted_notes:ie.ciphertext,iv:ie.iv})).success&&(m++,b.add(te))}catch($){console.error("Failed to import password:",$)}Re({current:r.notes.length+k+1,total:s})}let S=t.dataManagement.importSuccess.replace("{notes}",a.toString()).replace("{passwords}",m.toString());if(l>0||u>0){const k=[];l>0&&k.push(o==="zh-CN"?`${l} 个重复笔记`:`${l} duplicate notes`),u>0&&k.push(o==="zh-CN"?`${u} 个重复密码`:`${u} duplicate passwords`),S+=` (${o==="zh-CN"?"跳过":"Skipped"} ${k.join(o==="zh-CN"?"、":" and ")})`}ze({type:"success",text:S}),await Te(),await Ee()}catch(s){console.error("Import failed:",s),ze({type:"error",text:t.dataManagement.importFailed})}finally{Pr(!1),Re({current:0,total:0}),Ve.current&&(Ve.current.value="")}},Va=async r=>{var a;if((a=r.target.files)!=null&&a[0]){ze({type:"error",text:o==="zh-CN"?"🎭 Demo 模式下不支持数据导入功能":"🎭 Data import is not available in Demo mode"}),Ve.current&&(Ve.current.value="");return}},Ua=r=>{if(!r)return"Unknown";const s=r.split(".");if(s.length===4)return`${s[0]}.***.***.${s[3]}`;if(r.includes(":")){const a=r.split(":").filter(c=>c!=="");if(a.length===0)return"::***";if(a.length===1)return`${a[0]}::***`;const l=a[0],d=a[a.length-1];return`${l}:****:****:****:****:****:****:${d}`}return r},Oa=r=>{xa(s=>{const a=new Set(s);return a.has(r)?a.delete(r):a.add(r),a})},ws=async()=>{var r;try{if(Pe(""),kt()){tt(io),Kt(5),st(!1),at(!1);return}const s=await C.getSessions();if(!s.success||!s.data){Pe(((r=s.error)==null?void 0:r.message)||t.errors.loadNotesFailed);return}tt(s.data.sessions),Kt(s.data.max_devices);const a=co();ha(a);const l=await xo(a);es(l)}catch(s){Pe(s.message||t.errors.loadNotesFailed)}finally{st(!1),at(!1)}},Ja=()=>{at(!0),ws()},Ka=async()=>{try{await go(ga),es(null),Tr(o==="zh-CN"?"已关闭自动解锁":"Auto-unlock disabled"),setTimeout(()=>Tr(""),3e3)}catch(r){Pe((o==="zh-CN"?"关闭自动解锁失败：":"Failed to disable auto-unlock: ")+r.message)}},qa=async r=>{var s;Zt(a=>new Set(a).add(r)),Pe("");try{const a=await C.revokeSession(r);if(!a.success){Pe(((s=a.error)==null?void 0:s.message)||t.devices.logoutFailed);return}tt(_r.map(l=>l.id===r?{...l,is_active:!1}:l)),Tr(t.devices.logoutSuccess),setTimeout(()=>Tr(""),3e3)}catch(a){Pe(a.message||t.devices.logoutFailed)}finally{Zt(a=>{const l=new Set(a);return l.delete(r),l})}},Ga=r=>{const s=new Date(r),a=new Date;if(s.toDateString()===a.toDateString())return`${t.common.today} ${s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}`;const l=new Date(a);return l.setDate(l.getDate()-1),s.toDateString()===l.toDateString()?`${t.common.yesterday} ${s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}`:s.toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Qa=r=>new Date(r).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Ya=r=>{if(!r)return t.devices.types.unknown;switch(r){case"desktop":return t.devices.types.desktop;case"mobile":return t.devices.types.mobile;case"tablet":return t.devices.types.tablet;default:return t.devices.types.unknown}};return n.useEffect(()=>{rt&&_r.length===0&&(st(!0),ws())},[rt]),e.jsxs("div",{className:"h-dvh overflow-hidden flex flex-col bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-500 text-white px-6 py-3 text-center text-sm font-medium",children:no[o]}),e.jsx("header",{className:"bg-white/80 dark:bg-gray-800/50 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:e.jsx("div",{className:"max-w-[1800px] mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/AnyNote/LOGO_REMOVED",alt:"AnyNote",className:"w-8 h-8 select-none"}),e.jsx("h1",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-blue-400",children:"AnyNote"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{j(_==="light"?"dark":"light")},className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors p-1.5 hover:bg-gray-200 dark:hover:bg-gray-700/50 rounded-lg",title:_==="light"?t.nav.themeDark:t.nav.themeLight,children:_==="light"?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),e.jsx("button",{onClick:()=>z(o==="zh-CN"?"en-US":"zh-CN"),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors px-2 py-1.5 hover:bg-gray-200 dark:hover:bg-gray-700/50 rounded-lg text-sm font-medium",title:o==="zh-CN"?"Switch to English":"切换到中文",children:o==="zh-CN"?"EN":"中"}),e.jsx("div",{className:"h-4 w-px bg-gray-300 dark:bg-gray-700"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>We(!St),className:"flex items-center gap-2 hover:opacity-80 transition-opacity",title:i==null?void 0:i.email,children:e.jsx("div",{className:`w-8 h-8 rounded-full ${ps((i==null?void 0:i.email)||"")} flex items-center justify-center text-white font-semibold text-sm`,children:bs(tr||(i==null?void 0:i.email)||"")})}),St&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>We(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-20 overflow-hidden",children:[e.jsx("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-9 h-9 rounded-full ${ps((i==null?void 0:i.email)||"")} flex items-center justify-center text-white font-semibold text-sm flex-shrink-0`,children:bs(tr||(i==null?void 0:i.email)||"")}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:tr||(i==null?void 0:i.email)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:tr?Aa((i==null?void 0:i.email)||""):t.nav.account||"账号"})]}),e.jsx("button",{onClick:Wa,className:"flex-shrink-0 p-1 rounded text-gray-500 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:t.nav.editNickname,children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})}),e.jsxs("button",{onClick:()=>{We(!1),Ot(!0)},className:"w-full px-3 py-2.5 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("span",{className:"truncate",children:t.nav.devices})]}),e.jsxs("button",{onClick:()=>{We(!1),Ut(!0)},className:"w-full px-3 py-2.5 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),e.jsx("span",{className:"truncate",children:t.nav.dataManagement})]}),e.jsxs("button",{onClick:Fa,className:"w-full px-3 py-2.5 text-left text-sm text-red-600 dark:text-red-400 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{className:"truncate",children:t.nav.logout})]})]})]})]})]})]})})}),Ct&&e.jsx("div",{className:"fixed top-20 right-6 z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-red-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-2 max-w-md",children:[e.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium flex-1",children:Ct}),e.jsx("button",{onClick:()=>h(""),className:"ml-2 p-0.5 hover:bg-red-600/50 rounded transition-colors flex-shrink-0",title:o==="zh-CN"?"关闭":"Close",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),Y&&e.jsx(po,{message:Y.message,variant:Y.variant,onClose:fr}),e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col py-6",children:e.jsx("div",{className:"max-w-[1800px] mx-auto px-4 sm:px-6 flex-1 flex flex-col min-h-0 min-w-0 w-full",children:rr?e.jsxs("div",{className:"flex flex-col h-[calc(90vh-65px)]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-3 py-3 bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h2",{className:"text-base md:text-lg font-semibold text-gray-900 dark:text-white truncate",children:[w?t.notes.editNote:t.notes.newNoteTitle,e.jsxs("span",{className:"hidden sm:inline",children:[" - ",t.notes.fullscreenMode]})]}),w&&e.jsxs("div",{className:"hidden sm:flex items-center",children:[Z==="saving"&&e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400 flex items-center gap-1 ml-2 flex-shrink-0",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:t.common.saving})]}),Z==="saved"&&re.current>0&&e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 ml-2 flex-shrink-0",children:[e.jsx("svg",{className:"w-3 h-3 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:ys(re.current)})]}),Z==="error"&&e.jsxs("span",{className:"text-xs text-red-600 dark:text-red-400 flex items-center gap-1 ml-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),t.common.saveFailed]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Jr(!1),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.notes.exitFullscreen,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("button",{onClick:()=>Dr(!1),disabled:q,className:"px-2.5 py-1.5 sm:px-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5",children:[q&&e.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-sm",children:t.common.save})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row gap-4 md:gap-6 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("textarea",{value:y,onChange:r=>{const s=r.target.value;s.length>=1e5&&y.length<1e5&&(h(o==="zh-CN"?"⚠️ 笔记内容已达上限（100,000 字符）":"⚠️ Note content limit reached (100,000 chars)"),setTimeout(()=>h(""),5e3)),ae(s),B("unsaved")},placeholder:t.notes.contentPlaceholder,maxLength:1e5,className:"flex-1 px-4 md:px-6 py-4 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-white/60 dark:border-white/10 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-600 focus:outline-none focus:border-blue-400/60 focus:bg-white/70 dark:focus:bg-gray-900/70 transition-all font-mono text-sm md:text-base resize-none overflow-y-auto leading-relaxed",style:{fontFamily:"'JetBrains Mono', 'Fira Code', 'Consolas', monospace"}}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-xs bg-gray-50 dark:bg-gray-800/50 rounded-b-lg -mt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("span",{className:`font-medium ${y.length>9e4?"text-red-600 dark:text-red-400":y.length>75e3?"text-orange-600 dark:text-orange-400":"text-gray-500 dark:text-gray-400"}`,children:[y.length.toLocaleString()," / 100,000 ",o==="zh-CN"?"字符":"chars"]}),y.length>75e3&&y.length<=9e4&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-600 dark:text-orange-400",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o==="zh-CN"?"笔记较长，建议拆分":"Note is long, consider splitting"]}),y.length>9e4&&e.jsxs("span",{className:"flex items-center gap-1 text-red-600 dark:text-red-400 font-medium",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),o==="zh-CN"?"即将达到上限！":"Approaching limit!"]})]})]}),e.jsx("div",{className:"hidden md:flex flex-1 flex-col overflow-hidden bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg",children:e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"markdown-preview prose dark:prose-invert max-w-none",children:e.jsx(ft,{onError:r=>{console.error("[Markdown渲染错误]",r)},children:Ba})})})})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 flex-1 min-h-0 w-full",children:[e.jsx("div",{className:`md:col-span-1 flex flex-col min-h-0 ${Or||T||E==="passwords"&&ge==="edit"?"hidden md:flex":""}`,children:e.jsxs("div",{className:"card !px-6 !py-3 bg-white/70 dark:bg-gray-900/70 backdrop-blur-2xl border border-white/60 dark:border-white/20 shadow-[0_30px_80px_-35px_rgba(37,99,235,0.4)] dark:shadow-[0_30px_80px_-35px_rgba(96,165,250,0.5)] rounded-2xl flex-1 flex flex-col overflow-hidden min-h-0",children:[e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>ms("notes"),className:`flex-1 px-4 py-2 text-sm font-medium transition-all hover:scale-[1.02] ${E==="notes"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-500/10":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700/30"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),t.notes.listTitle]})}),e.jsx("button",{onClick:()=>ms("passwords"),className:`flex-1 px-4 py-2 text-sm font-medium transition-all hover:scale-[1.02] ${E==="passwords"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400 bg-blue-50 dark:bg-blue-500/10":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700/30"}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),t.passwords.listTitle]})})]}),e.jsxs("div",{className:`flex-1 flex flex-col overflow-hidden ${E==="notes"?"":"hidden"}`,children:[e.jsxs("div",{className:"py-2",children:[Be&&Be.warning&&!Ys&&e.jsx("div",{className:`mb-3 px-3 py-2 rounded-lg border text-sm ${Be.allowed?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800 text-orange-700 dark:text-orange-300":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("span",{className:"flex-1",children:Be.allowed?o==="zh-CN"?"数量较多，建议精简":"Too many notes, clean up":o==="zh-CN"?"已达上限，请删除旧笔记":"Limit reached, delete old notes"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[Be.current,"/",Be.hardLimit]}),e.jsx("button",{onClick:ya,className:"ml-1 p-0.5 hover:bg-orange-200 dark:hover:bg-orange-800 rounded transition-colors",title:o==="zh-CN"?"关闭提示":"Dismiss",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",value:or,onChange:r=>Dt(r.target.value),onKeyDown:r=>r.key==="Enter"&&ds(),placeholder:o==="zh-CN"?"搜索笔记...":"Search...",maxLength:16,className:"w-full px-3 py-2 pl-9 pr-12 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[or&&e.jsx("button",{onClick:()=>{Dt(""),Et("")},className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:o==="zh-CN"?"清空":"Clear",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),or&&e.jsx("button",{onClick:ds,className:"p-1 text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:o==="zh-CN"?"搜索":"Search",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]}),e.jsxs("select",{value:x,onChange:r=>{const s=Number(r.target.value);yt.getState().setItemsPerPage(s),Cr(1),Ce==="server"&&Te(1,s)},className:"px-2 py-2 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white focus:outline-none focus:border-blue-500/50 transition-colors cursor-pointer appearance-none pr-8 bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2212%22%20height%3D%2212%22%20viewBox%3D%220%200%2012%2012%22%3E%3Cpath%20fill%3D%22%23666%22%20d%3D%22M6%209L1%204h10z%22%2F%3E%3C%2Fsvg%3E')] bg-[length:12px_12px] bg-[position:right_0.5rem_center] bg-no-repeat",title:o==="zh-CN"?"每页显示数量":"Items per page",children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("button",{onClick:ba,className:"p-2 rounded-lg bg-blue-500/20 text-blue-600 dark:text-blue-400 hover:bg-blue-500/30 transition-colors border border-blue-500/30",title:t.common.new,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),aa?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-500 py-8",children:t.notes.loading}):yr.totalItems===0?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-500 py-8 text-sm",children:ke?o==="zh-CN"?`未找到包含 "${ke}" 的笔记`:`No notes found for "${ke}"`:t.notes.noNotes}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2 overflow-y-auto py-2 flex-1",children:yr.items.map(r=>e.jsxs("div",{className:`relative p-2 rounded-lg transition-all group ${(w==null?void 0:w.id)===r.id&&E==="notes"?"bg-blue-100/70 dark:bg-blue-500/30 backdrop-blur-md border-2 border-blue-400/60 dark:border-blue-400/40 shadow-lg shadow-blue-500/20":"bg-white/40 dark:bg-gray-800/40 backdrop-blur-md hover:bg-white/60 dark:hover:bg-gray-800/60 border-2 border-white/40 dark:border-white/10 hover:border-white/60 dark:hover:border-white/20 hover:shadow-md"}`,children:[e.jsxs("button",{onClick:()=>pa(r),className:"w-full text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate text-sm pr-8",title:r.title||t.notes.untitled,children:r.title||t.notes.untitled}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate mt-1",title:r.content&&typeof r.content=="string"?r.content.substring(0,100):"",children:r.content&&typeof r.content=="string"?r.content.substring(0,50)+"...":""}),r.tags&&r.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[r.tags.slice(0,3).map((s,a)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-xs rounded border border-blue-200 dark:border-blue-800",children:s},a)),r.tags.length>3&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 text-gray-500 dark:text-gray-400 text-xs",children:["+",r.tags.length-3]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:new Date(r.updated_at*1e3).toLocaleDateString(o==="zh-CN"?"zh-CN":"en-US")})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),J(r),La()},className:"absolute top-2 right-2 visible md:invisible md:group-hover:visible text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 p-1",title:t.common.delete,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},r.id))}),e.jsx(us,{currentPage:yr.currentPage,totalPages:yr.totalPages,totalItems:yr.totalItems,onPageChange:r=>{Cr(r),Ce==="server"&&Te(r,x)}})]})]}),e.jsxs("div",{className:`flex-1 flex flex-col overflow-hidden ${E==="passwords"?"":"hidden"}`,children:[e.jsxs("div",{className:"py-2",children:[$e&&$e.warning&&!Zs&&e.jsx("div",{className:`mb-3 px-3 py-2 rounded-lg border text-sm ${$e.allowed?"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800 text-orange-700 dark:text-orange-300":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-700 dark:text-red-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("span",{className:"flex-1",children:$e.allowed?o==="zh-CN"?"数量较多，建议精简":"Too many passwords, clean up":o==="zh-CN"?"已达上限，请删除旧密码":"Limit reached, delete old passwords"}),e.jsxs("span",{className:"font-medium whitespace-nowrap",children:[$e.current,"/",$e.hardLimit]}),e.jsx("button",{onClick:ka,className:"ml-1 p-0.5 hover:bg-orange-200 dark:hover:bg-orange-800 rounded transition-colors",title:o==="zh-CN"?"关闭提示":"Dismiss",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",value:nr,onChange:r=>$t(r.target.value),onKeyDown:r=>r.key==="Enter"&&is(),placeholder:o==="zh-CN"?"搜索密码...":"Search...",maxLength:16,className:"w-full px-3 py-2 pl-9 pr-12 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors"}),e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[nr&&e.jsx("button",{onClick:()=>{$t(""),Bt("")},className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:o==="zh-CN"?"清空":"Clear",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),nr&&e.jsx("button",{onClick:is,className:"p-1 text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:o==="zh-CN"?"搜索":"Search",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]}),e.jsxs("select",{value:x,onChange:r=>{const s=Number(r.target.value);yt.getState().setItemsPerPage(s),Lr(1),Le==="server"&&Ee(1,s)},className:"px-2 py-2 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white focus:outline-none focus:border-blue-500/50 transition-colors cursor-pointer appearance-none pr-8 bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2212%22%20height%3D%2212%22%20viewBox%3D%220%200%2012%2012%22%3E%3Cpath%20fill%3D%22%23666%22%20d%3D%22M6%209L1%204h10z%22%2F%3E%3C%2Fsvg%3E')] bg-[length:12px_12px] bg-[position:right_0.5rem_center] bg-no-repeat",title:o==="zh-CN"?"每页显示数量":"Items per page",children:[e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("button",{onClick:cs,className:"p-2 rounded-lg bg-blue-500/20 text-blue-600 dark:text-blue-400 hover:bg-blue-500/30 transition-colors border border-blue-500/30",title:t.common.new,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),kr.totalItems===0?e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-500 py-8 text-sm",children:fe?o==="zh-CN"?`未找到包含 "${fe}" 的密码`:`No passwords found for "${fe}"`:t.passwords.noPasswords}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2 overflow-y-auto py-2 flex-1",children:kr.items.map(r=>e.jsxs("div",{className:`relative p-2 rounded-lg transition-all group ${(T==null?void 0:T.id)===r.id&&E==="passwords"?"bg-blue-100/70 dark:bg-blue-500/30 backdrop-blur-md border-2 border-blue-400/60 dark:border-blue-400/40 shadow-lg shadow-blue-500/20":"bg-white/40 dark:bg-gray-800/40 backdrop-blur-md hover:bg-white/60 dark:hover:bg-gray-800/60 border-2 border-white/40 dark:border-white/10 hover:border-white/60 dark:hover:border-white/20 hover:shadow-md"}`,children:[e.jsxs("button",{onClick:()=>Sa(r),className:"w-full text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white truncate text-sm pr-8",title:r.site,children:r.site}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate mt-1",title:r.username,children:r.username}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:new Date(r.updated_at*1e3).toLocaleDateString(o==="zh-CN"?"zh-CN":"en-US")})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),xe(r),_a()},className:"absolute top-2 right-2 visible md:invisible md:group-hover:visible text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 p-1",title:t.common.delete,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},r.id))}),e.jsx(us,{currentPage:kr.currentPage,totalPages:kr.totalPages,totalItems:kr.totalItems,onPageChange:r=>{Lr(r),Le==="server"&&Ee(r,x)}})]})]})]})}),e.jsxs("div",{className:`md:col-span-2 card !px-6 !py-3 bg-white/70 dark:bg-gray-900/70 backdrop-blur-2xl border border-white/60 dark:border-white/20 shadow-[0_30px_80px_-35px_rgba(37,99,235,0.4)] dark:shadow-[0_30px_80px_-35px_rgba(96,165,250,0.5)] rounded-2xl min-h-0 ${E==="notes"&&!Or||E==="passwords"&&!T&&ge==="preview"?"hidden md:flex md:flex-col":"flex flex-col"}`,children:[E==="notes"&&e.jsx(e.Fragment,{children:Or?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-300 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Ir,className:"md:hidden p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.common.back,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:w?U==="preview"?t.notes.noteDetails:t.notes.editNote:t.notes.newNoteTitle}),w&&e.jsxs("div",{className:"hidden sm:flex items-center",children:[Z==="saving"&&e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400 flex items-center gap-1 ml-2 flex-shrink-0",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:t.common.saving})]}),Z==="saved"&&re.current>0&&e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1 ml-2 flex-shrink-0",children:[e.jsx("svg",{className:"w-3 h-3 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:ys(re.current)})]}),Z==="error"&&e.jsxs("span",{className:"text-xs text-red-600 dark:text-red-400 flex items-center gap-1 ml-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),t.common.saveFailed]})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("button",{onClick:Ir,className:"hidden md:flex p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.common.back,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),U==="edit"&&e.jsx("button",{onClick:()=>Jr(!rr),className:"hidden md:flex p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:rr?t.notes.exitFullscreen:t.notes.fullscreenEdit,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:rr?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),w&&e.jsx("button",{onClick:()=>Ae(U==="edit"?"preview":"edit"),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:U==="edit"?t.common.preview:t.common.edit,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:U==="edit"?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),U==="edit"&&e.jsxs("button",{onClick:()=>Dr(!1),disabled:q,className:"px-2.5 py-1.5 sm:px-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5",children:[q&&e.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-sm",children:t.common.save})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[U==="edit"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:pe,onChange:r=>{ce(r.target.value),B("unsaved")},placeholder:t.notes.titlePlaceholder,maxLength:32,className:"w-full px-2 py-2 pr-12 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors"}),e.jsxs("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[pe.length,"/32"]})]}),W.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 p-2 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg",children:W.map((r,s)=>e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-sm rounded-md border border-blue-200 dark:border-blue-800",children:[e.jsx("span",{children:r}),e.jsx("button",{onClick:()=>{ee(W.filter((a,l)=>l!==s)),B("unsaved")},className:"hover:bg-blue-200 dark:hover:bg-blue-800/50 rounded-sm p-0.5 transition-colors",title:o==="zh-CN"?"删除标签":"Remove tag",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s))}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:V,onChange:r=>{const a=32-W.join("").length,l=r.target.value.slice(0,a);be(l)},onKeyDown:r=>{if(r.key==="Enter"&&V.trim()){r.preventDefault();const s=V.trim();if(W.join("").length+s.length>32){h(o==="zh-CN"?"标签总字符数已达上限（最多32个字符）":"Total tag characters limit reached (max 32 characters)"),setTimeout(()=>h(""),3e3);return}if(s.length===0)return;W.includes(s)||(ee([...W,s]),B("unsaved")),be("")}},placeholder:t.notes.tagsPlaceholder,disabled:W.join("").length>=32,className:"w-full px-2 py-2 pr-16 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("button",{onClick:()=>{if(V.trim()){const r=V.trim();if(W.join("").length+r.length>32){h(o==="zh-CN"?"标签总字符数已达上限（最多32个字符）":"Total tag characters limit reached (max 32 characters)"),setTimeout(()=>h(""),3e3);return}if(r.length===0)return;W.includes(r)||(ee([...W,r]),B("unsaved")),be("")}},disabled:!V.trim()||W.join("").length+V.trim().length>32,title:o==="zh-CN"?"添加标签":"Add tag",className:"absolute right-9 top-1/2 -translate-y-1/2 p-1 rounded text-blue-600 dark:text-blue-400 hover:bg-blue-500/10 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e.jsxs("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500 pointer-events-none",children:[W.join("").length+V.length,"/32"]})]})]}),U==="edit"?rr?e.jsxs("div",{className:"flex-1 flex gap-4 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("textarea",{value:y,onChange:r=>{const s=r.target.value;s.length>=1e5&&y.length<1e5&&(h(o==="zh-CN"?"⚠️ 笔记内容已达上限（100,000 字符）":"⚠️ Note content limit reached (100,000 chars)"),setTimeout(()=>h(""),5e3)),ae(s),B("unsaved")},placeholder:`开始编写你的笔记...

支持 Markdown 语法`,maxLength:1e5,className:"flex-1 px-6 py-4 bg-gray-900/50 backdrop-blur-sm border border-white/10 rounded-t-lg text-white placeholder-gray-600 focus:outline-none focus:border-blue-400/60 focus:bg-gray-900/70 transition-all font-mono text-base resize-none overflow-y-auto leading-relaxed",style:{fontFamily:"'JetBrains Mono', 'Fira Code', 'Consolas', monospace"}}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-xs bg-gray-800/80 border border-gray-700 border-t-0 rounded-b-lg",children:[e.jsxs("span",{className:`font-medium ${y.length>9e4?"text-red-400":y.length>75e3?"text-orange-400":"text-gray-400"}`,children:[y.length.toLocaleString()," / 100,000 字符"]}),y.length>75e3&&y.length<=9e4&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-400",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"笔记较长，建议拆分"]}),y.length>9e4&&e.jsxs("span",{className:"flex items-center gap-1 text-red-400 font-medium",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"即将达到上限！"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-white/60 dark:border-white/10 rounded-lg p-6",children:e.jsx("div",{className:"markdown-preview prose dark:prose-invert max-w-none",children:e.jsx(ft,{onError:r=>{console.error("[Markdown渲染错误-全屏模式]",r)},children:Da})})})})]}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx("textarea",{value:y,onChange:r=>{const s=r.target.value;s.length>=1e5&&y.length<1e5&&(h(o==="zh-CN"?"⚠️ 笔记内容已达上限（100,000 字符）":"⚠️ Note content limit reached (100,000 chars)"),setTimeout(()=>h(""),5e3)),ae(s),B("unsaved")},placeholder:t.notes.contentPlaceholder,maxLength:1e5,className:"w-full h-[400px] px-6 py-4 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm border border-white/60 dark:border-white/10 rounded-t-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-600 focus:outline-none focus:border-blue-400/60 focus:bg-white/70 dark:focus:bg-gray-900/70 transition-all font-mono text-base resize-none overflow-y-auto leading-relaxed",style:{fontFamily:"'JetBrains Mono', 'Fira Code', 'Consolas', monospace"}}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 text-xs bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 border-t-0 rounded-b-lg",children:[e.jsxs("span",{className:`font-medium ${y.length>9e4?"text-red-600 dark:text-red-400":y.length>75e3?"text-orange-600 dark:text-orange-400":"text-gray-500 dark:text-gray-400"}`,children:[y.length.toLocaleString()," / 100,000 ",o==="zh-CN"?"字符":"chars"]}),y.length>75e3&&y.length<=9e4&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-600 dark:text-orange-400",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o==="zh-CN"?"笔记较长，建议拆分":"Note is long, consider splitting"]}),y.length>9e4&&e.jsxs("span",{className:"flex items-center gap-1 text-red-600 dark:text-red-400 font-medium",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),o==="zh-CN"?"即将达到上限！":"Approaching limit!"]})]})]}):e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[pe&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-2",children:e.jsx("p",{className:"text-xl text-gray-900 dark:text-white font-semibold",children:pe})}),W.length>0&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:W.map((r,s)=>e.jsx("span",{className:"inline-flex items-center px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-sm rounded-md border border-blue-200 dark:border-blue-800",children:r},s))})}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-2",children:ns&&!y?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-gray-300 dark:bg-gray-700 rounded w-4/5"}),e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsxs("svg",{className:"animate-spin h-6 w-6 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"ml-3 text-sm text-gray-600 dark:text-gray-400",children:o==="zh-CN"?"正在加载笔记...":"Loading note..."})]})]}):e.jsx("div",{className:"markdown-preview prose dark:prose-invert max-w-none",children:xt()?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-300 dark:border-blue-500/40 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"为保证兼容性，已使用简化渲染器。如需完整功能，建议使用编辑模式或更新浏览器。"})]})}),e.jsx(bo,{content:y||"",className:"prose dark:prose-invert max-w-none"})]}):e.jsx(ft,{onError:r=>{console.error("[Markdown渲染错误-预览模式]",r)},children:$a})})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-200",children:t.notes.securityTip})})]})}),U==="edit"&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-200",children:t.notes.securityTip})})]})})]}):e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:t.markdownTutorial.syntaxGuide}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.heading.title}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:`# ${o==="zh-CN"?"一级标题":"Heading 1"}
## ${o==="zh-CN"?"二级标题":"Heading 2"}
### ${o==="zh-CN"?"三级标题":"Heading 3"}
#### ${o==="zh-CN"?"四级标题":"Heading 4"}`}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-2",children:t.markdownTutorial.heading.warning})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.textStyle}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:`**${o==="zh-CN"?"粗体文字":"Bold Text"}**
*${o==="zh-CN"?"斜体文字":"Italic Text"}*
~~${o==="zh-CN"?"删除线":"Strikethrough"}~~
\`${o==="zh-CN"?"行内代码":"Inline Code"}\``})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.list}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:`- ${o==="zh-CN"?"无序列表项 1":"Unordered List Item 1"}
- ${o==="zh-CN"?"无序列表项 2":"Unordered List Item 2"}

1. ${o==="zh-CN"?"有序列表项 1":"Ordered List Item 1"}
2. ${o==="zh-CN"?"有序列表项 2":"Ordered List Item 2"}`})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.codeBlock}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:'```javascript\nfunction hello() {\n  console.log("Hello World!");\n}\n```'})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.link}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:`[${o==="zh-CN"?"链接文字":"Link Text"}](https://example.com)
![${o==="zh-CN"?"图片描述":"Image Description"}](https://example.com/image.png)`})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.quote}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:`> ${o==="zh-CN"?"这是一段引用文字":"This is a quote"}
> ${o==="zh-CN"?"可以有多行":"Can have multiple lines"}`})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.table}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:`| ${o==="zh-CN"?"列1":"Col 1"} | ${o==="zh-CN"?"列2":"Col 2"} | ${o==="zh-CN"?"列3":"Col 3"} |
| --- | --- | --- |
| ${o==="zh-CN"?"内容1":"Content 1"} | ${o==="zh-CN"?"内容2":"Content 2"} | ${o==="zh-CN"?"内容3":"Content 3"} |`})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:t.markdownTutorial.separator}),e.jsx("pre",{className:"text-sm text-green-700 dark:text-green-400 bg-gray-100 dark:bg-gray-900 p-3 rounded overflow-x-auto",children:"---"})]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-6 mt-8",children:[e.jsx("h2",{className:"text-xl font-bold text-blue-700 dark:text-blue-300 mb-3",children:t.markdownTutorial.tips.title}),e.jsx("ul",{className:"list-disc list-inside text-gray-700 dark:text-gray-300 space-y-2",children:t.markdownTutorial.tips.items.map((r,s)=>e.jsx("li",{children:r},s))})]})]})})})}),E==="passwords"&&e.jsx(e.Fragment,{children:!T&&ge==="preview"?e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"prose dark:prose-invert max-w-none",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:o==="zh-CN"?"功能说明":"Features"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:o==="zh-CN"?"网站/应用名称":"Website/App Name"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:o==="zh-CN"?"输入完整的网站 URL（如 https://github.com）或应用名称。支持直接点击打开网站。":"Enter full website URL (e.g. https://github.com) or app name. Click to open directly."})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:o==="zh-CN"?"用户名/邮箱":"Username/Email"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:o==="zh-CN"?"存储登录账号，支持邮箱、手机号、用户名等任意格式。点击复制按钮快速复制。":"Store login account, supports email, phone, username, etc. Click copy button to copy quickly."})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:o==="zh-CN"?"密码/Token/密钥":"Password/Token/Key"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-2",children:o==="zh-CN"?"存储密码、API Token、SSH 密钥等敏感信息。支持密码生成器创建强密码。":"Store passwords, API tokens, SSH keys, etc. Use password generator to create strong passwords."}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"密码生成器选项：":"Password Generator Options:"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsx("li",{children:o==="zh-CN"?"长度：16-32 位（更安全的随机密码）":"Length: 16-32 chars (more secure random passwords)"}),e.jsx("li",{children:o==="zh-CN"?"字符类型：大写字母、小写字母、数字、符号":"Character types: Uppercase, lowercase, numbers, symbols"}),e.jsx("li",{children:o==="zh-CN"?"实时强度检测，确保密码安全":"Real-time strength detection for security"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:o==="zh-CN"?"备注":"Notes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:o==="zh-CN"?"存储额外信息，如恢复码、安全问题答案、MFA 密钥等。支持多行文本。":"Store additional info like recovery codes, security question answers, MFA secrets, etc. Supports multi-line text."})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2",children:o==="zh-CN"?"安全提示":"Security Tips"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsx("li",{children:o==="zh-CN"?"使用密码生成器创建强密码（16-32 位）":"Use password generator for strong passwords (16-32 chars)"}),e.jsx("li",{children:o==="zh-CN"?"每个网站使用不同的密码，避免密码重用":"Use different passwords for each site, avoid reuse"}),e.jsx("li",{children:o==="zh-CN"?"定期更新重要账号的密码":"Update passwords for important accounts regularly"}),e.jsx("li",{children:o==="zh-CN"?"在其他网站启用 2FA，可将恢复码存储在备注中":"Enable 2FA on other sites, store recovery codes in notes field"}),e.jsx("li",{children:o==="zh-CN"?"不要与他人分享主密码":"Never share your master password"})]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-4 mt-8",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-200",children:o==="zh-CN"?"提示：所有密码数据采用 AES-256-GCM 加密，主密码永不上传服务器，服务器无法解密您的数据。":"Tip: All password data is encrypted with AES-256-GCM. Master password never leaves your device, server cannot decrypt your data."})})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 py-2 border-b border-gray-300 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Ir,className:"md:hidden p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.common.back,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:T?ge==="preview"?t.passwords.passwordDetails:t.passwords.editPassword:t.passwords.newPasswordTitle})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("button",{onClick:Ir,className:"hidden md:flex p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.common.back,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),T&&e.jsx("button",{onClick:()=>vr(ge==="edit"?"preview":"edit"),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:ge==="edit"?t.common.preview:t.common.edit,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:ge==="edit"?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),ge==="edit"&&e.jsxs("button",{onClick:Pa,disabled:q,className:"px-2.5 py-1.5 sm:px-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1.5",children:[q&&e.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{className:"text-sm",children:t.common.save})]})]})]}),ge==="preview"?e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:t.passwords.site}),A&&xs(A)&&e.jsxs("a",{href:gs(A),target:"_blank",rel:"noopener noreferrer",className:"text-sm px-3 py-1.5 rounded-lg bg-blue-500/20 text-blue-600 dark:text-blue-400 hover:bg-blue-500/30 transition-colors border border-blue-500/30 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),t.common.open]})]}),A&&xs(A)?e.jsx("a",{href:gs(A),target:"_blank",rel:"noopener noreferrer",className:"text-lg text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium underline decoration-blue-600/30 dark:decoration-blue-400/30 hover:decoration-blue-600 dark:hover:decoration-blue-400 transition-colors break-all",children:A}):e.jsx("p",{className:"text-lg text-gray-900 dark:text-white font-medium",children:A||(o==="zh-CN"?"未设置":"Not set")})]}),K&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:t.passwords.username}),e.jsx("button",{onClick:()=>br(K,t.passwords.username),className:"p-2 rounded-lg bg-blue-500/20 text-blue-600 dark:text-blue-400 hover:bg-blue-500/30 transition-colors border border-blue-500/30",title:t.common.copy,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),e.jsx("p",{className:"password-preview-content text-base text-gray-900 dark:text-white",children:K})]}),H&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:t.passwords.password}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>wr(!ye),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:ye?t.common.hide:t.common.show,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:ye?"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21":"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})})}),e.jsx("button",{onClick:za,disabled:_t,className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-500/20 text-orange-700 dark:text-orange-400 hover:bg-orange-200 dark:hover:bg-orange-500/30 transition-colors border border-orange-300 dark:border-orange-500/30 disabled:opacity-50 disabled:cursor-not-allowed",title:o==="zh-CN"?"检查密码是否泄露":"Check if password is breached",children:_t?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsx("button",{onClick:()=>br(H,t.passwords.password),className:"p-2 rounded-lg bg-blue-500/20 text-blue-600 dark:text-blue-400 hover:bg-blue-500/30 transition-colors border border-blue-500/30",title:t.common.copy,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),e.jsx("p",{className:"password-preview-content text-base text-gray-900 dark:text-white font-mono",children:ye?H:"••••••••••••••••"}),I&&e.jsx("div",{className:`mt-3 p-3 rounded-lg border ${I.severity==="safe"?"bg-green-50 dark:bg-green-900/20 border-green-300 dark:border-green-500/30":I.severity==="low"||I.severity==="medium"?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-300 dark:border-yellow-500/30":"bg-red-50 dark:bg-red-900/20 border-red-300 dark:border-red-500/30"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${I.severity==="safe"?"text-green-600 dark:text-green-400":I.severity==="low"||I.severity==="medium"?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:I.severity==="safe"?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-semibold ${I.severity==="safe"?"text-green-700 dark:text-green-200":I.severity==="low"||I.severity==="medium"?"text-yellow-700 dark:text-yellow-200":"text-red-700 dark:text-red-200"}`,children:I.breached?o==="zh-CN"?"密码已泄露！":"Password Breached!":o==="zh-CN"?"密码安全":"Password Safe"}),e.jsx("p",{className:`text-xs mt-1 ${I.severity==="safe"?"text-green-600 dark:text-green-300":I.severity==="low"||I.severity==="medium"?"text-yellow-600 dark:text-yellow-300":"text-red-600 dark:text-red-300"}`,children:I.breached?o==="zh-CN"?`此密码在 ${I.count.toLocaleString()} 次数据泄露事件中出现，强烈建议立即更换！`:`This password appeared in ${I.count.toLocaleString()} data breaches. Strongly recommend changing it immediately!`:o==="zh-CN"?"此密码未在已知的数据泄露事件中出现，但仍建议定期更换密码。":"This password was not found in known data breaches, but we still recommend changing it regularly."})]})]})})]}),G&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-2",children:t.passwords.notes}),e.jsx("button",{onClick:()=>br(G,t.passwords.notes),className:"p-2 rounded-lg bg-blue-500/20 text-blue-600 dark:text-blue-400 hover:bg-blue-500/30 transition-colors border border-blue-500/30",title:t.common.copy,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),e.jsx("p",{className:"text-base text-gray-900 dark:text-white whitespace-pre-wrap break-words",children:G})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-200",children:t.passwords.securityTip})})]})}):e.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.passwords.site}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:A,onChange:r=>{Qe(r.target.value),de(!0)},placeholder:t.passwords.sitePlaceholder,maxLength:32,className:"w-full px-4 py-2 pr-16 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors"}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[A.length,"/32"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.passwords.username}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:K,onChange:r=>{Ye(r.target.value),de(!0)},placeholder:t.passwords.usernamePlaceholder,maxLength:32,className:"w-full px-4 py-2 pr-16 sm:pr-32 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline",children:[K.length,"/32"]}),K&&e.jsxs("button",{onClick:()=>br(K,t.passwords.username),className:"text-sm px-2 sm:px-3 py-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.common.copy,children:[e.jsx("span",{className:"hidden sm:inline",children:t.common.copy}),e.jsx("svg",{className:"w-4 h-4 sm:hidden",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.passwords.password}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:ye?"text":"password",value:H,onChange:r=>{De(r.target.value),de(!0)},placeholder:t.passwords.passwordPlaceholder,maxLength:32,className:"w-full px-4 py-2 pr-32 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors font-mono text-sm"}),e.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 flex-wrap justify-end",children:[e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 mr-1 hidden sm:inline",children:[H.length,"/32"]}),e.jsx("button",{onClick:()=>wr(!ye),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:ye?t.common.hide:t.common.show,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:ye?"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21":"M15 12a3 3 0 11-6 0 3 3 0 016 0z M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})})}),e.jsx("button",{onClick:()=>Nt(!jt),className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-500/20 text-blue-700 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-500/30 transition-colors border border-blue-300 dark:border-blue-500/30",title:t.common.generate,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),H&&e.jsx("button",{onClick:()=>br(H,t.passwords.password),className:"p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",title:t.common.copy,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})]}),jt&&e.jsxs("div",{className:"mt-3 p-4 bg-gray-50 dark:bg-gray-900/70 border border-blue-300 dark:border-blue-500/30 rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.passwords.generator.length.replace("{length}",String(Fr))}),e.jsx("input",{type:"range",min:"16",max:"32",value:Fr,onChange:r=>Xs(Number(r.target.value)),className:"w-full h-2 bg-gray-300 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-500 mt-1",children:[e.jsx("span",{children:"16"}),e.jsx("span",{children:"24"}),e.jsx("span",{children:"32"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:Hr,onChange:r=>ea(r.target.checked),className:"w-4 h-4 text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors",children:t.passwords.generator.uppercase})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:Rr,onChange:r=>ra(r.target.checked),className:"w-4 h-4 text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors",children:t.passwords.generator.lowercase})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:Vr,onChange:r=>ta(r.target.checked),className:"w-4 h-4 text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors",children:t.passwords.generator.digits})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:Ur,onChange:r=>sa(r.target.checked),className:"w-4 h-4 text-blue-500 bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white transition-colors",children:t.passwords.generator.symbols})]})]}),e.jsx("button",{onClick:Ma,className:"w-full px-4 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all font-medium",children:t.passwords.generator.generate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.passwords.notes}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:G,onChange:r=>{Ze(r.target.value),de(!0)},placeholder:t.passwords.notesPlaceholder,maxLength:512,className:"w-full px-4 py-2 pb-7 bg-white dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-blue-500/50 transition-colors resize-none h-32"}),e.jsxs("span",{className:`absolute right-3 bottom-2 text-xs pointer-events-none ${G.length>450?"text-orange-600 dark:text-orange-400":"text-gray-400 dark:text-gray-500"}`,children:[G.length,"/512"]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-200",children:t.passwords.securityTip})})]})})]})})]})]})})}),na&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white/95 dark:bg-gray-900/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_60px_-20px_rgba(0,0,0,0.2)] dark:shadow-[0_20px_60px_-20px_rgba(0,0,0,0.5)] w-full max-w-sm border border-gray-200/50 dark:border-white/10",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-7 h-7 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t.nav.setNickname}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o==="zh-CN"?"设置个性化昵称（最多8个字符）":"Set personalized nickname (max 8 chars)"})]})]})}),e.jsx("div",{className:"px-6 py-5",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"邮箱账号":"Email Account"}),e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-white text-sm truncate",children:i==null?void 0:i.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.nav.nickname}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Kr,onChange:r=>{const s=r.target.value.replace(/\s/g,"");Mt(s)},maxLength:8,placeholder:tr||(o==="zh-CN"?"输入昵称（不支持空格）":"Enter nickname (no spaces)"),className:"w-full px-4 py-2.5 pr-12 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",onKeyDown:r=>{if(r.key===" "){r.preventDefault();return}r.key==="Enter"?fs():r.key==="Escape"&&(jr(!1),he(""))},autoFocus:!0}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-500 dark:text-gray-400",children:[Kr.length,"/8"]})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:o==="zh-CN"?"💡 提示：昵称为空时将显示邮箱":"💡 Tip: Email will be shown if nickname is empty"})]})]})}),Pt&&e.jsx("div",{className:"px-6 py-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 flex-1",children:Pt})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{jr(!1),he("")},disabled:sr,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:t.common.cancel}),e.jsxs("button",{onClick:fs,disabled:sr,className:"px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[sr&&e.jsx("svg",{className:"animate-spin w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 12a8 8 0 018-8v8H4z"})}),sr?o==="zh-CN"?"保存中...":"Saving...":t.common.save]})]})]})}),ia&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white/95 dark:bg-gray-900/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_60px_-20px_rgba(0,0,0,0.2)] dark:shadow-[0_20px_60px_-20px_rgba(0,0,0,0.5)] w-full max-w-md border border-gray-200/50 dark:border-white/10",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-7 h-7 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:o==="zh-CN"?"重新输入主密码":"Re-enter Master Password"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:o==="zh-CN"?"为了保护您的数据安全，请重新输入主密码":"To protect your data, please re-enter your master password"})]})]}),e.jsx("div",{className:"px-6 py-3 bg-blue-50 dark:bg-blue-900/20 border-y border-blue-100 dark:border-blue-800",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:o==="zh-CN"?'💡 提示：登录时勾选"记住我7天"可避免重复输入密码':'💡 Tip: Check "Remember me for 7 days" at login to avoid re-entering password'})]})})]}),e.jsx("div",{className:"px-6 py-5",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"账号":"Account"}),e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-900 dark:text-white",children:i==null?void 0:i.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"主密码":"Master Password"}),e.jsx("input",{type:"password",value:zr,onChange:r=>Gr(r.target.value),onKeyDown:r=>{r.key==="Enter"&&!He&&ks()},placeholder:o==="zh-CN"?"请输入主密码":"Enter your master password",className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0,disabled:He})]}),Vt&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-500/30 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-700 dark:text-red-200",children:Vt})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-500/30 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-200",children:o==="zh-CN"?"💡 您的会话仍然有效，只需重新输入主密码即可继续使用，无需重新登录。":"💡 Your session is still valid. Just re-enter your password to continue, no need to login again."})})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[e.jsx("button",{onClick:Ia,className:"flex-1 px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-all font-medium",disabled:He,children:o==="zh-CN"?"重新登录":"Login Again"}),e.jsxs("button",{onClick:ks,className:"flex-1 px-4 py-2 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",disabled:He||!zr.trim(),children:[He&&e.jsxs("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),He?o==="zh-CN"?"恢复中...":"Restoring...":o==="zh-CN"?"确认":"Confirm"]})]})]})}),da&&g&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-xl w-full max-w-md sm:max-w-2xl md:max-w-4xl max-h-[85vh] overflow-hidden flex flex-col border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("svg",{className:"w-6 h-6 sm:w-7 sm:h-7 text-yellow-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white truncate",children:((js=t.conflicts)==null?void 0:js.title)||"检测到版本冲突"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400 mt-1 hidden sm:block",children:((Ns=t.conflicts)==null?void 0:Ns.subtitle)||"这篇笔记已在其他设备修改。你的修改已自动备份，不会丢失。请选择保留哪个版本："})]})]}),e.jsx("button",{onClick:()=>{dr(!1),ir(null),$r(!1),pr("")},className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors p-1 flex-shrink-0",title:t.common.back||"返回继续编辑",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-2 sm:hidden",children:((Cs=t.conflicts)==null?void 0:Cs.subtitle)||"这篇笔记已在其他设备修改。你的修改已自动备份，不会丢失。请选择保留哪个版本："})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 flex flex-col",children:wa?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden flex flex-col max-h-[200px]",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 px-3 sm:px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),((Is=t.conflicts)==null?void 0:Is.localVersion)||"你的版本"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:e.jsx("pre",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono leading-relaxed",children:g.localContent})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden flex flex-col max-h-[200px]",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 px-3 sm:px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})}),((Ws=t.conflicts)==null?void 0:Ws.serverVersion)||"服务器版本"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:e.jsx("pre",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono leading-relaxed",children:g.serverContent})})]})]})}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 px-3 sm:px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),((Fs=t.conflicts)==null?void 0:Fs.mergedVersion)||"合并后的版本"]})}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsx("textarea",{value:je,onChange:r=>pr(r.target.value),placeholder:((Hs=t.conflicts)==null?void 0:Hs.mergePlaceholder)||"在此处手动合并两个版本的内容...",className:"w-full h-[200px] px-3 py-2 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg text-xs sm:text-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 font-mono focus:outline-none focus:border-blue-500 dark:focus:border-blue-400 resize-none"}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[je.length," 字符"]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:Na,disabled:q||!je.trim(),className:"px-4 py-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:q?t.common.saving:((Rs=t.conflicts)==null?void 0:Rs.applyMerge)||"保存合并结果"})]}),e.jsxs("button",{onClick:Ca,disabled:q,className:"px-4 py-3 rounded-lg bg-gray-200 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-700 transition-all text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed border border-gray-300 dark:border-gray-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:t.common.cancel})]})]}),e.jsx("div",{className:"mt-3 bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"flex-1 text-xs text-gray-700 dark:text-gray-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:((Vs=t.conflicts)==null?void 0:Vs.mergeInstructions)||"合并说明"}),e.jsx("p",{className:"leading-relaxed",children:((Us=t.conflicts)==null?void 0:Us.mergeHint)||"手动合并本地版本和服务器版本的内容，完成后点击保存。"})]})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden flex flex-col max-h-[45vh]",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 px-3 sm:px-4 py-2 sm:py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-sm sm:text-base font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),((Ls=t.conflicts)==null?void 0:Ls.localVersion)||"你的版本（本地）"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:(()=>{const{localLines:r}=Gs(g.localContent,g.serverContent);return e.jsx("div",{className:"font-mono text-xs sm:text-sm",children:r.map((s,a)=>{const l=s.type==="same"?"":s.type==="modified"?"bg-yellow-50 dark:bg-yellow-900/20":s.type==="added"?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20";return e.jsxs("div",{className:`flex ${l} hover:bg-gray-100 dark:hover:bg-gray-800/50`,children:[e.jsx("span",{className:"inline-block w-10 text-right pr-3 py-1 text-gray-400 dark:text-gray-500 select-none flex-shrink-0 border-r border-gray-300 dark:border-gray-600",children:s.lineNumber}),e.jsx("span",{className:"flex-1 px-3 py-1 text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-all",children:s.content||" "})]},a)})})})()}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[g.localContent.length," ",((Ss=t.conflicts)==null?void 0:Ss.characters)||"字符"]}),e.jsxs("span",{children:[((Ms=t.conflicts)==null?void 0:Ms.version)||"版本"," ",g.localVersion]})]}),g.localTags&&g.localTags.length>0&&e.jsxs("div",{className:"mt-2 sm:mt-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1.5",children:[o==="zh-CN"?"标签":"Tags",":"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:g.localTags.map((r,s)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs rounded border border-blue-200 dark:border-blue-800",children:r},s))})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden flex flex-col max-h-[45vh]",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900/50 px-3 sm:px-4 py-2 sm:py-3 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h3",{className:"text-sm sm:text-base font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"})}),((zs=t.conflicts)==null?void 0:zs.serverVersion)||"服务器版本（其他设备）"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:(()=>{const{serverLines:r}=Gs(g.localContent,g.serverContent);return e.jsx("div",{className:"font-mono text-xs sm:text-sm",children:r.map((s,a)=>{const l=s.type==="same"?"":s.type==="modified"?"bg-yellow-50 dark:bg-yellow-900/20":s.type==="added"?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20";return e.jsxs("div",{className:`flex ${l} hover:bg-gray-100 dark:hover:bg-gray-800/50`,children:[e.jsx("span",{className:"inline-block w-10 text-right pr-3 py-1 text-gray-400 dark:text-gray-500 select-none flex-shrink-0 border-r border-gray-300 dark:border-gray-600",children:s.lineNumber}),e.jsx("span",{className:"flex-1 px-3 py-1 text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-all",children:s.content||" "})]},a)})})})()}),e.jsxs("div",{className:"mt-2 sm:mt-3 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[g.serverContent.length," ",((Ps=t.conflicts)==null?void 0:Ps.characters)||"字符"]}),e.jsxs("span",{children:[((_s=t.conflicts)==null?void 0:_s.version)||"版本"," ",g.serverVersion," ",((Ts=t.conflicts)==null?void 0:Ts.latest)||"（最新）"]})]}),g.serverTags&&g.serverTags.length>0&&e.jsxs("div",{className:"mt-2 sm:mt-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1.5",children:[o==="zh-CN"?"标签":"Tags",":"]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:g.serverTags.map((r,s)=>e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs rounded border border-blue-200 dark:border-blue-800",children:r},s))})]})]})]})]})}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 flex-shrink-0",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:fa,disabled:q,className:"px-4 py-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 transition-all text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:q?t.common.saving:((Es=t.conflicts)==null?void 0:Es.useLocal)||"使用我的版本"})]}),e.jsxs("button",{onClick:va,disabled:q,className:"px-4 py-3 rounded-lg bg-gray-600 dark:bg-gray-700 text-white hover:bg-gray-700 dark:hover:bg-gray-600 transition-all text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:((Bs=t.conflicts)==null?void 0:Bs.useServer)||"使用服务器版本"})]}),e.jsxs("button",{onClick:ja,disabled:q,className:"px-4 py-3 rounded-lg bg-gray-200 dark:bg-gray-700/50 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-700 transition-all text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed border border-gray-300 dark:border-gray-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),e.jsx("span",{children:((Ds=t.conflicts)==null?void 0:Ds.manualMerge)||"手动合并"})]})]}),e.jsx("div",{className:"mt-3 bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"flex-1 text-xs text-gray-700 dark:text-gray-300",children:[e.jsx("p",{className:"font-semibold mb-1",children:(($s=t.conflicts)==null?void 0:$s.backupNotice)||"数据安全保障"}),e.jsx("p",{className:"leading-relaxed",children:((As=t.conflicts)==null?void 0:As.backupInfo)||"无论你选择哪个版本，你的本地修改都已安全保存到浏览器本地存储。"})]})]})})]})]})})]})}),Wt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl p-6 max-w-md w-full mx-4 border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-100 dark:bg-red-900/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),e.jsx("h3",{className:"text-lg font-semibold text-center text-gray-900 dark:text-white mb-2",children:Wt}),e.jsx("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400 mb-6",children:t.errors.countdownMessage.replace("{countdown}",Ft.toString())}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500 dark:bg-red-600 transition-all duration-1000 ease-linear",style:{width:`${Ft/15*100}%`}})})}),e.jsxs("button",{onClick:ls,className:"w-full px-4 py-3 rounded-lg bg-red-500 hover:bg-red-600 text-white font-medium transition-colors flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})}),e.jsx("span",{children:t.errors.redirectNow})]})]})}),ca&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-8 py-4",children:e.jsxs("div",{className:"bg-white/95 dark:bg-gray-900/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_60px_-20px_rgba(0,0,0,0.2)] dark:shadow-[0_20px_60px_-20px_rgba(0,0,0,0.5)] w-full max-w-md sm:max-w-lg max-h-[90vh] overflow-hidden border border-gray-200/50 dark:border-white/10",children:[e.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),t.nav.dataManagement]}),e.jsx("button",{onClick:()=>{Ut(!1),ze(null)},className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-5 overflow-y-auto max-h-[calc(90vh-120px)] space-y-4",children:[et&&e.jsx("div",{className:`p-2.5 rounded-lg text-sm ${et.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-400":"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-400"}`,children:et.text}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white mb-2",children:t.dataManagement.exportData}),e.jsxs("div",{className:"mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded text-xs text-blue-800 dark:text-blue-400 flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("span",{children:o==="zh-CN"?"备份文件将使用独立密码加密（AES-256-GCM），确保数据安全。":"Backup files are encrypted with an independent password (AES-256-GCM) to ensure data security."})]}),e.jsx("button",{onClick:()=>lt(!0),disabled:ss,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:ss?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Zr.total>0?t.dataManagement.exportProgress.replace("{current}",Zr.current.toString()).replace("{total}",Zr.total.toString()):t.dataManagement.exportButton]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),t.dataManagement.exportButton]})})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white mb-2",children:t.dataManagement.importData}),e.jsxs("div",{className:"mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded text-xs text-blue-800 dark:text-blue-400 flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:o==="zh-CN"?"仅支持加密备份文件导入，需要输入导出时设置的密码。所有数据采用端到端加密，确保隐私安全。":"Only encrypted backup files are supported. You need to enter the password set during export. All data is end-to-end encrypted for privacy protection."})]}),e.jsx("input",{ref:Ve,type:"file",accept:".json",onChange:Va,disabled:Yr,className:"hidden"}),e.jsx("button",{onClick:()=>{var r;return(r=Ve.current)==null?void 0:r.click()},disabled:Yr,className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:Yr?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Xr.total>0?t.dataManagement.importProgress.replace("{current}",Xr.current.toString()).replace("{total}",Xr.total.toString()):t.dataManagement.importButton]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),t.dataManagement.importButton]})})]})]})]})}),ma&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-8 py-4",children:e.jsxs("div",{className:"bg-white/95 dark:bg-gray-900/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_60px_-20px_rgba(0,0,0,0.2)] dark:shadow-[0_20px_60px_-20px_rgba(0,0,0,0.5)] w-full max-w-md border border-gray-200/50 dark:border-white/10 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o==="zh-CN"?"设置导出密码":"Set Export Password"}),e.jsx("button",{onClick:()=>{lt(!1),dt(""),it(""),cr("")},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:o==="zh-CN"?"请设置一个导出密码（至少8个字符）。此密码独立于主密码，用于加密导出文件。导入时需要输入此密码。":"Set an export password (at least 8 characters). This password is independent of your master password and will be required when importing the encrypted file."}),as&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:as})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"导出密码":"Export Password"}),e.jsx("input",{type:"password",value:rs,onChange:r=>{dt(r.target.value),cr("")},placeholder:o==="zh-CN"?"至少8个字符":"At least 8 characters",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"确认密码":"Confirm Password"}),e.jsx("input",{type:"password",value:ts,onChange:r=>{it(r.target.value),cr("")},placeholder:o==="zh-CN"?"再次输入密码":"Re-enter password",className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{lt(!1),dt(""),it(""),cr("")},className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:o==="zh-CN"?"取消":"Cancel"}),e.jsx("button",{onClick:Ha,disabled:!rs||!ts,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:o==="zh-CN"?"开始导出":"Start Export"})]})]})}),ua&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-8 py-4",children:e.jsxs("div",{className:"bg-white/95 dark:bg-gray-900/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_60px_-20px_rgba(0,0,0,0.2)] dark:shadow-[0_20px_60px_-20px_rgba(0,0,0,0.5)] w-full max-w-md border border-gray-200/50 dark:border-white/10 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o==="zh-CN"?"输入解密密码":"Enter Decryption Password"}),e.jsx("button",{onClick:()=>{ct(!1),gr(""),Er(null)},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:o==="zh-CN"?"检测到加密备份文件，请输入导出时设置的密码。":"Encrypted backup file detected. Please enter the password set during export."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:o==="zh-CN"?"解密密码":"Decryption Password"}),e.jsx("input",{type:"password",value:xr,onChange:r=>gr(r.target.value),placeholder:o==="zh-CN"?"输入导出密码":"Enter export password",onKeyDown:r=>{r.key==="Enter"&&xr&&vs()},className:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{ct(!1),gr(""),Er(null)},className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:o==="zh-CN"?"取消":"Cancel"}),e.jsx("button",{onClick:vs,disabled:!xr,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:o==="zh-CN"?"解密并导入":"Decrypt and Import"})]})]})}),rt&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-8 py-4",children:e.jsxs("div",{className:"bg-white/95 dark:bg-gray-900/90 backdrop-blur-xl rounded-2xl shadow-[0_20px_60px_-20px_rgba(0,0,0,0.2)] dark:shadow-[0_20px_60px_-20px_rgba(0,0,0,0.5)] w-full max-w-md sm:max-w-lg max-h-[90vh] overflow-hidden border border-gray-200/50 dark:border-white/10 flex flex-col",children:[e.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between flex-shrink-0",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})}),t.devices.title]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Ja,disabled:Qt,title:t.devices.refreshDevices,className:"p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx("svg",{className:`w-4 h-4 ${Qt?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>Ot(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),Xt&&e.jsx("div",{className:"absolute top-4 right-4 z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-green-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"font-medium",children:Xt})]})}),e.jsxs("div",{className:"p-5 overflow-y-auto flex-1",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:t.devices.subtitle.replace("{max}",Jt.toString())}),Gt&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:Gt})}),qt&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("svg",{className:"animate-spin h-8 w-8 mx-auto text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:t.notes.loading})]}),!qt&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900 dark:text-blue-100",children:t.devices.deviceLimit}),e.jsx("p",{className:"mt-1 text-sm text-blue-800 dark:text-blue-200",children:t.devices.deviceLimitInfo.replace("{max}",Jt.toString())})]})]})}),_r.filter(r=>r.is_active).length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.devices.noDevices})}):e.jsx("div",{className:"space-y-3",children:_r.filter(r=>r.is_active).map(r=>e.jsx("div",{className:`p-4 rounded-lg border ${r.is_current?"border-2 border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white truncate mb-1",children:r.device_name||t.devices.types.unknown}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1.5 text-xs text-gray-600 dark:text-gray-400",children:[r.device_type&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.devices.deviceType,":"]}),e.jsx("span",{children:Ya(r.device_type)})]}),r.browser_name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.devices.browser,":"]}),e.jsx("span",{children:r.browser_name})]}),r.os_name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.devices.os,":"]}),e.jsx("span",{children:r.os_name})]}),r.ip_address&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.devices.ipAddress,":"]}),e.jsx("span",{className:"font-mono text-xs",children:ot.has(r.id)?r.ip_address:Ua(r.ip_address)}),e.jsx("button",{onClick:()=>Oa(r.id),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors p-0.5",title:ot.has(r.id)?"隐藏IP":"显示完整IP",children:ot.has(r.id)?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),r.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.devices.location,":"]}),e.jsx("span",{children:r.location})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:[t.devices.loginTime,":"]}),e.jsx("span",{children:Ga(r.created_at)})]}),r.is_current&&(nt&&nt>Date.now()?e.jsxs("div",{className:"col-span-full flex items-center gap-2 mt-2 px-3 py-2 bg-green-50 dark:bg-green-900/20 border border-green-300 dark:border-green-700 rounded-lg",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"flex-1 text-xs",children:[e.jsx("div",{className:"text-green-800 dark:text-green-200 font-medium",children:t.devices.autoUnlockEnabledStatus}),e.jsx("div",{className:"text-green-700 dark:text-green-300 mt-0.5",children:t.devices.autoUnlockExpiry.replace("{time}",Qa(nt))})]}),e.jsx("button",{onClick:Ka,className:"text-xs px-2 py-1 rounded border border-green-600 dark:border-green-400 text-green-700 dark:text-green-300 hover:bg-green-100 dark:hover:bg-green-900/40 transition-colors flex-shrink-0",title:t.devices.autoUnlockDisable,children:t.devices.autoUnlockDisable})]}):e.jsxs("div",{className:"col-span-full flex items-center gap-2 mt-2 px-3 py-2 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("div",{className:"flex-1 text-xs text-gray-600 dark:text-gray-400",children:t.devices.autoUnlockHint})]}))]})]}),!r.is_current&&e.jsx("button",{onClick:()=>qa(r.id),disabled:Yt.has(r.id),title:t.devices.logoutDevice,className:"p-2 rounded-lg border border-red-300 dark:border-red-800 bg-white dark:bg-gray-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",children:Yt.has(r.id)?e.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})},r.id))}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:t.devices.securityTip})})]})]})]})}),me]})}export{Do as default};
//# sourceMappingURL=NotesPage-C9jK8LRD.js.map
