const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotesPage-C9jK8LRD.js","assets/markdown-vendor-CHUou9Sa.js","assets/react-vendor-9esfqqE9.js","assets/index-Dt62Q5Mp.js","assets/zustand-vendor-CzPTHOhB.js","assets/index-D7p6glqb.css","assets/crypto-DgWI3rvl.js","assets/device-C8OUsEf4.js","assets/crypto-vendor-DLELI0UM.js","assets/index-DmPTVDsj.js","assets/Toast-ClRAtSG1.js","assets/NotesPage-B3pgEpGO.css"])))=>i.map(i=>d[i]);
import{u as ee,a as re,_ as te,b as _}from"./index-Dt62Q5Mp.js";import{j as e}from"./markdown-vendor-CHUou9Sa.js";import{u as se,r as s,L as ae}from"./react-vendor-9esfqqE9.js";import{E as oe}from"./index-C-GWJ8ez.js";import{c as M}from"./crypto-DgWI3rvl.js";import{u as ne}from"./index-DmPTVDsj.js";import"./zustand-vendor-CzPTHOhB.js";function ue(){const I=se(),q=ee(r=>r.login),{getResolvedTheme:D}=re(),{t}=ne();s.useEffect(()=>{te(()=>import("./NotesPage-C9jK8LRD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))},[]);const[m,F]=s.useState(""),[d,$]=s.useState(""),[g,K]=s.useState(""),[x,O]=s.useState(""),[N,f]=s.useState(!1),[S,n]=s.useState(""),[a,W]=s.useState(0),[y,b]=s.useState(""),[w,u]=s.useState(""),[h,k]=s.useState(""),[v,C]=s.useState(""),[j,E]=s.useState(""),z=r=>r.length>0&&r.length<12?(u(t.errors.emailTooShort),!1):r.length>32?(u(t.errors.emailTooLong),!1):r.length>=12&&!r.includes("@")?(u(t.errors.emailInvalidFormat),!1):(u(""),!0),B=r=>r.length>0&&r.length<12?(k(t.errors.passwordMinLength),!1):r.length>32?(k(t.errors.passwordMaxLength),!1):(k(""),!0),P=r=>r.length>0&&r!==d?(C(t.errors.confirmPasswordMismatch),!1):(C(""),!0),U=r=>r.length>32?(E(t.errors.inviteCodeMaxLength),!1):(E(""),!0),H=r=>{F(r),z(r)},V=r=>{$(r);const o=M.calculatePasswordStrength(r);W(o),B(r),g.length>0&&P(g)},G=r=>{K(r),P(r)},J=r=>{O(r),U(r)},Q=()=>a<40?"bg-red-500":a<60?"bg-yellow-500":a<80?"bg-blue-500":"bg-green-500",X=()=>a<40?t.register.passwordStrength.weak:a<60?t.register.passwordStrength.medium:a<80?t.register.passwordStrength.strong:t.register.passwordStrength.veryStrong,Y=async r=>{var o,L,T;if(r.preventDefault(),n(""),!y){n(t.errors.turnstileRequired);return}if(!x.trim()){n(t.errors.inviteCodeRequired);return}if(d!==g){n(t.errors.passwordMismatch);return}if(a<60){n(t.errors.passwordTooWeak);return}f(!0);try{const{salt:l,authHash:c}=await M.initialize(d,m),i=await _.register(m,c,l,x,y);if(!i.success||!i.data){let p="注册失败，请稍后重试";((o=i.error)==null?void 0:o.code)==="TIMEOUT"?p="网络请求超时，请检查网络连接后重试":((L=i.error)==null?void 0:L.code)==="NETWORK_ERROR"?p="网络连接失败，请检查网络后重试":(T=i.error)!=null&&T.message&&(p=i.error.message),n(p),f(!1);return}const{user:A,token:R}=i.data;_.setToken(R);const Z={...A,user_id:A.id};q(Z,R),I("/notes")}catch(l){let c="注册失败，请稍后重试";l.name==="TypeError"&&l.message.includes("fetch")?c="网络连接失败，请检查您的网络连接":l.message&&(c=l.message),n(c),f(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-12 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("img",{src:"/logo.svg",alt:"AnyNote",className:"w-16 h-16 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:t.register.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.register.securityNote})]})]}),S&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:S})}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.register.email}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"email",type:"email",value:m,onChange:r=>H(r.target.value),required:!0,autoComplete:"email",minLength:12,maxLength:32,className:`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${w?"border-2 border-red-500 dark:border-red-500":"border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}`,placeholder:t.register.emailPlaceholder}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[m.length,"/32"]})]}),w&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:w})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.register.password}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:"password",value:d,onChange:r=>{const o=r.target.value.replace(/\s/g,"");V(o)},onKeyDown:r=>{r.key===" "&&r.preventDefault()},required:!0,autoComplete:"new-password",minLength:12,maxLength:32,className:`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${h?"border-2 border-red-500 dark:border-red-500":"border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}`,placeholder:t.register.passwordPlaceholder}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[d.length,"/32"]})]}),h&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:h}),d&&!h&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${Q()}`,style:{width:`${a}%`}})}),e.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:X()})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:t.register.passwordStrength.recommendation})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.register.confirmPassword}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",type:"password",value:g,onChange:r=>{const o=r.target.value.replace(/\s/g,"");G(o)},onKeyDown:r=>{r.key===" "&&r.preventDefault()},required:!0,autoComplete:"new-password",minLength:12,maxLength:32,className:`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${v?"border-2 border-red-500 dark:border-red-500":"border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}`,placeholder:t.register.confirmPasswordPlaceholder}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[g.length,"/32"]})]}),v&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:v})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inviteCode",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t.register.inviteCode}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"inviteCode",type:"text",value:x,onChange:r=>J(r.target.value),required:!0,maxLength:32,className:`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${j?"border-2 border-red-500 dark:border-red-500":"border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent"}`,placeholder:t.register.inviteCodePlaceholder}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500",children:[x.length,"/32"]})]}),j&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:j})]}),e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:t.register.warningMessage})}),e.jsx("div",{className:"w-full",children:e.jsx(oe,{siteKey:"0x4AAAAAAB7UqdxFxx0kLl6i",onSuccess:r=>b(r),onError:()=>b(""),onExpire:()=>b(""),options:{theme:D(),size:"flexible"}})}),e.jsx("button",{type:"submit",disabled:N||!y,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:N?t.register.registering:t.register.registerButton})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.register.hasAccount," ",e.jsx(ae,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400",children:t.register.login})]})})]})})})}export{ue as default};
//# sourceMappingURL=RegisterPage-B7pYcIBJ.js.map
