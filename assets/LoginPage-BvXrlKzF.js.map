{"version":3,"mappings":"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","names":["LoginPage","navigate","useNavigate","login","useAuthStore","state","getResolvedTheme","useSettingsStore","useTranslation","useEffect","__vitePreload","email","setEmail","useState","password","setPassword","loading","setLoading","error","setError","turnstileToken","setTurnstileToken","rememberMe","setRememberMe","showAbout","setShowAbout","aboutContent","emailError","setEmailError","passwordError","setPasswordError","validateEmail","value","validatePassword","handleEmailChange","handlePasswordChange","handleSubmit","e","salt","crypto","saltResponse","api","errorMsg","_a","_b","authHash","deviceId","getOrCreateDeviceId","deviceName","getDeviceName","response","_c","_d","_e","user","token","refresh_token","expires_in","userWithId","encryptionKey","expiresAt","saveEncryptionKey","err","jsx","jsxs","item","index","icons","Turnstile","Link"],"ignoreList":[],"sources":["../../src/pages/LoginPage.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { Turnstile } from '@marsidev/react-turnstile';\nimport { useAuthStore } from '@/stores/auth-store';\nimport { useSettingsStore } from '@/stores/settings-store';\nimport { api } from '@/lib/api';\nimport { crypto } from '@/lib/crypto';\nimport { saveEncryptionKey } from '@/lib/key-storage';\nimport { getOrCreateDeviceId, getDeviceName } from '@/lib/device';\nimport { useTranslation } from '@/i18n';\n\nexport default function LoginPage() {\n  const navigate = useNavigate();\n  const login = useAuthStore((state) => state.login);\n  const { getResolvedTheme } = useSettingsStore();\n  const { t } = useTranslation();\n\n  // 预加载 NotesPage：用户打开登录页时，后台就开始下载笔记页面\n  useEffect(() => {\n    const preloadNotesPage = () => import('@/pages/NotesPage');\n    preloadNotesPage();\n  }, []);\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [turnstileToken, setTurnstileToken] = useState<string>('');\n  const [rememberMe, setRememberMe] = useState(false); // \"记住登陆\"选项\n  const [showAbout, setShowAbout] = useState(false);\n  const aboutContent = t.login.about;\n\n  // 实时验证错误\n  const [emailError, setEmailError] = useState('');\n  const [passwordError, setPasswordError] = useState('');\n\n  // 邮箱实时验证\n  const validateEmail = (value: string) => {\n    if (value.length > 0 && value.length < 12) {\n      setEmailError(t.errors.emailTooShort);\n      return false;\n    }\n    if (value.length > 32) {\n      setEmailError(t.errors.emailTooLong);\n      return false;\n    }\n    // 简单的邮箱格式验证\n    if (value.length >= 12 && !value.includes('@')) {\n      setEmailError(t.errors.emailInvalidFormat);\n      return false;\n    }\n    setEmailError('');\n    return true;\n  };\n\n  // 密码实时验证\n  const validatePassword = (value: string) => {\n    if (value.length > 0 && value.length < 12) {\n      setPasswordError(t.errors.passwordMinLength);\n      return false;\n    }\n    if (value.length > 32) {\n      setPasswordError(t.errors.passwordMaxLength);\n      return false;\n    }\n    setPasswordError('');\n    return true;\n  };\n\n  const handleEmailChange = (value: string) => {\n    setEmail(value);\n    validateEmail(value);\n  };\n\n  const handlePasswordChange = (value: string) => {\n    setPassword(value);\n    validatePassword(value);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n\n    // 验证 Turnstile token\n    if (!turnstileToken) {\n      setError(t.errors.turnstileRequired);\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      // 1. 获取用户的盐值\n      let salt = crypto.getSalt(email);\n\n      if (!salt) {\n        // 如果本地没有盐值，从服务器获取\n        const saltResponse = await api.getSalt(email);\n        if (!saltResponse.success || !saltResponse.data) {\n          const errorMsg = saltResponse.error?.code === 'TIMEOUT'\n            ? '网络请求超时，请检查网络连接后重试'\n            : saltResponse.error?.message || '无法获取加密密钥，请稍后重试';\n          setError(errorMsg);\n          setLoading(false);\n          return;\n        }\n        salt = saltResponse.data.salt;\n      }\n\n      // 2. 使用主密码和盐值派生认证哈希\n      const authHash = await crypto.restore(password, email, salt);\n\n      // 3. 获取设备信息\n      const deviceId = getOrCreateDeviceId();\n      const deviceName = getDeviceName();\n\n      // 4. 调用登录 API（传入设备信息和 Turnstile token）\n      const response = await api.login(email, authHash, deviceId, deviceName, turnstileToken);\n\n      if (!response.success || !response.data) {\n        let errorMsg = '登录失败，请检查邮箱和密码';\n\n        // 根据错误代码提供详细提示\n        if (response.error?.code === 'TIMEOUT') {\n          errorMsg = '网络请求超时，请检查网络连接后重试';\n        } else if (response.error?.code === 'NETWORK_ERROR') {\n          errorMsg = '网络连接失败，请检查网络后重试';\n        } else if (response.error?.message) {\n          errorMsg = response.error.message;\n        }\n\n        setError(errorMsg);\n        setLoading(false);\n        return;\n      }\n\n      // 5. 🔐 安全增强：保存认证信息（包含 refresh_token）\n      const { user, token, refresh_token, expires_in } = response.data;\n      api.setToken(token, expires_in ? Date.now() + expires_in * 1000 : undefined);\n      if (refresh_token) {\n        api.setRefreshToken(refresh_token);\n      }\n      // 添加 user_id 字段（与 id 相同）\n      const userWithId = { ...user, user_id: user.id };\n      login(userWithId, token, refresh_token, expires_in);\n\n      // 6. 如果勾选了\"记住我\"，保存加密密钥到 IndexedDB\n      if (rememberMe) {\n        try {\n          const encryptionKey = crypto.getEncryptionKey();\n          if (!encryptionKey) {\n            console.error('Failed to save encryption key: key is null');\n            // 不阻止登录，只是记录错误\n          } else {\n            const deviceId = getOrCreateDeviceId();\n            const expiresAt = Date.now() + 7 * 24 * 60 * 60 * 1000; // 7天后过期\n            await saveEncryptionKey(deviceId, encryptionKey, expiresAt);\n          }\n        } catch (err) {\n          console.error('Failed to save encryption key to IndexedDB:', err);\n          // 不阻止登录，只是记录错误\n        }\n      }\n\n      // 7. 跳转到笔记页面\n      navigate('/notes');\n    } catch (err: any) {\n      let errorMsg = '登录失败，请稍后重试';\n\n      // 捕获特定错误类型\n      if (err.name === 'TypeError' && err.message.includes('fetch')) {\n        errorMsg = '网络连接失败，请检查您的网络连接';\n      } else if (err.message) {\n        errorMsg = err.message;\n      }\n\n      setError(errorMsg);\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center px-4 py-12 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-blue-900/20\">\n      <div className=\"max-w-md w-full\">\n        <div className=\"card relative overflow-hidden\">\n          <button\n            type=\"button\"\n            onClick={() => setShowAbout(true)}\n            className=\"absolute right-4 top-4 z-10 p-0.5 text-gray-400 transition-all hover:text-gray-600 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary-500/60 dark:text-gray-500 dark:hover:text-gray-300\"\n            aria-label={aboutContent.button}\n          >\n            <svg className=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </button>\n\n          {showAbout && (\n            <div className=\"absolute inset-0 z-20 flex flex-col rounded-2xl border border-white/60 bg-white/90 p-6 text-left shadow-[0_30px_80px_-35px_rgba(37,99,235,0.3)] backdrop-blur-xl dark:border-white/10 dark:bg-gray-900/90 dark:shadow-[0_30px_80px_-35px_rgba(96,165,250,0.4)]\">\n              {/* 关闭按钮（绝对定位，与\"关于\"按钮位置一致） */}\n              <button\n                type=\"button\"\n                onClick={() => setShowAbout(false)}\n                className=\"absolute right-4 top-4 z-10 p-0.5 text-gray-400 transition-all hover:text-gray-600 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary-500/60 dark:text-gray-500 dark:hover:text-gray-300\"\n                aria-label={aboutContent.close}\n              >\n                <svg className=\"h-6 w-6\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n\n              {/* 头部：Logo + 标题 + 版本号 */}\n              <div className=\"flex items-start gap-4 mb-4 pr-10\">\n                <div className=\"flex items-center gap-3\">\n                  <img\n                    src=\"/logo.svg\"\n                    alt=\"AnyNote\"\n                    className=\"w-12 h-12 flex-shrink-0 drop-shadow-lg\"\n                  />\n                  <div>\n                    <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\n                      {aboutContent.title}\n                      <span className=\"text-xs font-normal text-gray-500 dark:text-gray-400 bg-gray-200/50 dark:bg-gray-700/50 px-2 py-0.5 rounded-full\">\n                        v1.0.0\n                      </span>\n                    </h3>\n                    <p className=\"mt-1 text-sm leading-6 text-gray-600 dark:text-gray-300\">{aboutContent.subtitle}</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* 核心特性卡片（2x2 Grid 布局） */}\n              <div className=\"flex-1 overflow-y-auto pr-1\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                  {aboutContent.features.map((item, index) => {\n                    // 为每个特性定制专属图标\n                    const icons = [\n                      // 零信任架构 - 盾牌图标\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                        <path d=\"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z\"/>\n                      </svg>,\n                      // 隐形同步 - 刷新图标\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                        <path d=\"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z\"/>\n                      </svg>,\n                      // 全方位安全 - 锁图标\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                        <path d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z\"/>\n                      </svg>,\n                      // 高效工作流 - 闪电图标\n                      <svg className=\"h-4 w-4\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                        <path d=\"M7 2v11h3v9l7-12h-4l4-8z\"/>\n                      </svg>\n                    ];\n\n                    return (\n                      <div\n                        key={item.title}\n                        className=\"group rounded-xl border border-white/50 bg-white/55 p-4 shadow-lg ring-1 ring-white/40 transition-all duration-200 hover:shadow-xl hover:scale-[1.02] backdrop-blur-sm dark:border-white/10 dark:bg-white/10 dark:ring-white/5 dark:hover:bg-white/15\"\n                      >\n                        <div className=\"flex items-start gap-3\">\n                          <span className=\"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg bg-primary-100 text-primary-600 shadow-md ring-1 ring-primary-200/50 transition-transform group-hover:scale-110 dark:bg-primary-500/20 dark:text-primary-300 dark:ring-primary-400/30\">\n                            {icons[index]}\n                          </span>\n                          <div className=\"flex-1 min-w-0\">\n                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white truncate\">{item.title}</h4>\n                            <p className=\"mt-1.5 text-xs leading-relaxed text-gray-600 dark:text-gray-300\">{item.description}</p>\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n\n              {/* 底部：开源信息 + GitHub 链接 */}\n              <div className=\"mt-5 pt-4 border-t border-white/30 dark:border-white/10 space-y-3\">\n                <div className=\"flex flex-wrap items-center gap-2 text-xs text-gray-600 dark:text-gray-300\">\n                  <span className=\"inline-flex items-center gap-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-2.5 py-1 rounded-full font-medium\">\n                    <svg className=\"w-3 h-3\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>\n                    </svg>\n                    MIT License\n                  </span>\n                  <span className=\"text-gray-500 dark:text-gray-400\">•</span>\n                  <span>{aboutContent.footer}</span>\n                </div>\n\n                <a\n                  href=\"https://github.com/aydomini/AnyNote\"\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  className=\"flex items-center justify-center gap-2 w-full rounded-lg border border-primary-300 bg-primary-100 px-4 py-2.5 text-sm font-semibold text-primary-700 shadow-sm transition-all hover:bg-primary-200 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-primary-400/60 dark:border-primary-500/40 dark:bg-primary-500/20 dark:text-primary-200 dark:hover:bg-primary-500/30\"\n                >\n                  <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                    <path d=\"M12 2C6.477 2 2 6.486 2 12.021c0 4.428 2.865 8.185 6.839 9.512.5.09.682-.218.682-.483 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.34-3.369-1.34-.455-1.159-1.11-1.468-1.11-1.468-.908-.62.069-.608.069-.608 1.004.071 1.532 1.033 1.532 1.033.892 1.531 2.341 1.088 2.91.832.091-.647.35-1.088.636-1.338-2.22-.254-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.254-.447-1.278.098-2.664 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844a9.53 9.53 0 012.503.337c1.909-1.296 2.748-1.026 2.748-1.026.546 1.386.202 2.41.1 2.664.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.694-4.566 4.943.359.309.679.919.679 1.852 0 1.336-.012 2.415-.012 2.743 0 .268.18.577.688.48A10.025 10.025 0 0022 12.021C22 6.486 17.523 2 12 2z\" />\n                  </svg>\n                  <span>{aboutContent.repoLabel}</span>\n                  <svg className=\"w-4 h-4 ml-1\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" />\n                  </svg>\n                </a>\n              </div>\n            </div>\n          )}\n\n          {/* Logo + 标题 */}\n          <div className=\"flex items-center gap-4 mb-6\">\n            <img src=\"/logo.svg\" alt=\"AnyNote\" className=\"w-16 h-16 flex-shrink-0\" />\n            <div className=\"flex-1\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-2\">\n                {t.login.title}\n              </h2>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                {t.login.securityNote}\n              </p>\n            </div>\n          </div>\n\n          {error && (\n            <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-800 rounded-lg\">\n              <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label\n                htmlFor=\"email\"\n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\"\n              >\n                {t.login.email}\n              </label>\n              <div className=\"relative\">\n                <input\n                  id=\"email\"\n                  type=\"email\"\n                  value={email}\n                  onChange={(e) => handleEmailChange(e.target.value)}\n                  required\n                  autoComplete=\"email\"\n                  minLength={12}\n                  maxLength={32}\n                  className={`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${\n                    emailError\n                      ? 'border-2 border-red-500 dark:border-red-500'\n                      : 'border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent'\n                  }`}\n                  placeholder={t.login.emailPlaceholder}\n                />\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500\">\n                  {email.length}/32\n                </span>\n              </div>\n              {emailError && (\n                <p className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                  {emailError}\n                </p>\n              )}\n            </div>\n\n            <div>\n              <label\n                htmlFor=\"password\"\n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\"\n              >\n                {t.login.password}\n              </label>\n              <div className=\"relative\">\n                <input\n                  id=\"password\"\n                  type=\"password\"\n                  value={password}\n                  onChange={(e) => {\n                    // 实时阻止空格输入\n                    const value = e.target.value.replace(/\\s/g, '');\n                    handlePasswordChange(value);\n                  }}\n                  onKeyDown={(e) => {\n                    // 阻止空格键\n                    if (e.key === ' ') {\n                      e.preventDefault();\n                    }\n                  }}\n                  required\n                  autoComplete=\"current-password\"\n                  minLength={12}\n                  maxLength={32}\n                  className={`w-full px-4 py-2 pr-16 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none ${\n                    passwordError\n                      ? 'border-2 border-red-500 dark:border-red-500'\n                      : 'border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-transparent'\n                  }`}\n                  placeholder={t.login.passwordPlaceholder}\n                />\n                <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 dark:text-gray-500\">\n                  {password.length}/32\n                </span>\n              </div>\n              {passwordError && (\n                <p className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                  {passwordError}\n                </p>\n              )}\n            </div>\n\n            {/* \"记住登陆\"选项 */}\n            <div className=\"flex items-center\">\n              <input\n                id=\"rememberMe\"\n                type=\"checkbox\"\n                checked={rememberMe}\n                onChange={(e) => setRememberMe(e.target.checked)}\n                className=\"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600\"\n              />\n              <label\n                htmlFor=\"rememberMe\"\n                className=\"ml-2 text-sm text-gray-700 dark:text-gray-300 cursor-pointer select-none\"\n              >\n                {t.login.rememberMe}\n              </label>\n              <div className=\"group relative ml-2\">\n                <svg className=\"w-4 h-4 text-gray-400 dark:text-gray-500 cursor-help\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                </svg>\n                <div className=\"invisible group-hover:visible absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 text-xs text-white bg-gray-900 dark:bg-gray-700 rounded-lg shadow-lg w-48 z-10\">\n                  {t.login.rememberMeTooltip}\n                  <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900 dark:border-t-gray-700\"></div>\n                </div>\n              </div>\n            </div>\n\n            {/* Cloudflare Turnstile 人机验证 */}\n            <div className=\"w-full\">\n              <Turnstile\n                siteKey={import.meta.env.VITE_TURNSTILE_SITE_KEY || '1x00000000000000000000AA'}\n                onSuccess={(token) => setTurnstileToken(token)}\n                onError={() => setTurnstileToken('')}\n                onExpire={() => setTurnstileToken('')}\n                options={{\n                  theme: getResolvedTheme(),\n                  size: 'flexible',\n                }}\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={loading || !turnstileToken}\n              className=\"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading ? t.login.loggingIn : t.login.loginButton}\n            </button>\n          </form>\n\n          <div className=\"mt-6 text-center\">\n            <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n              {t.login.noAccount}{' '}\n              <Link\n                to=\"/register\"\n                className=\"font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400\"\n              >\n                {t.login.register}\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"file":"assets/LoginPage-BvXrlKzF.js"}